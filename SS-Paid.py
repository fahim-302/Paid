import base64
print(base64.b64decode("IyEvdXNyL2Jpbi9weXRob24zDQojLSotY29kaW5nOnV0Zi04LSotDQojIFVwZGF0ZSBWMS42DQoNCiMjIyBJbXBvcnQgTW9kdWxlDQppbXBvcnQgcmVxdWVzdHMsYnM0LHN5cyxvcyxyYW5kb20sdGltZSxyZSxqc29uLHV1aWQsc3VicHJvY2VzcyxwbGF0Zm9ybSxiYXNlNjQNCmZyb20gcmFuZG9tIGltcG9ydCByYW5kaW50DQpmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yIGFzIFRocmVhZFBvb2wNCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwIGFzIHBhcg0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZQ0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUNCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQ0KDQoNCiMjIyBQZXJ1bXBhbWFhbiBNb2R1bGUgJiBTeW50YXgNCl9yZXFfc2VzXyAgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCl9yZXFfZ2V0XyAgPSByZXF1ZXN0cy5nZXQNCl9yZXFfcG9zdF8gPSByZXF1ZXN0cy5wb3N0DQpfanNfbG9fICAgID0ganNvbi5sb2Fkcw0KX2NpY2lfYXppbXZhdV8gICAgPSBpbnB1dA0KX2F6aW12YXVfZGFwdW50YV8gPSBvcGVuDQpfY2ljaV9jaWNpXyAgICAgICA9IGV4aXQNCg0KIyMjIENvbG9yDQpaID0gIlwwMzNbMTszMW0iICMgSGl0YW0NClAgPSAiXDAzM1sxOzMybSIgIyBQdXRpaA0KTSA9ICJcMDMzWzE7MzFtIiAjIE1lcmFoDQpIID0gIlwwMzNbMTszM20iICMgSGlqYXUNCksgPSAiXDAzM1sxOzMzbSIgIyBLdW5pbmcNCkIgPSAiXDAzM1sxOzM1bSIgIyBCaXJ1DQpVID0gIlwwMzNbMTszNm0iICMgVW5ndQ0KTyA9ICJcMDMzWzE7MzdtIiAjIEJpcnUgTXVkYQ0KTiA9ICJcMDMzWzBtIiAgICAjIFdhcm5hIE1hdGkNCg0KIyMjIEhvc3RzICYgQWNjb21tb2RhdGlvbg0KaG9zdCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iDQpvayA9IFtdDQpjcCA9IFtdDQp0dGwgPSBbXQ0KY291bnQgPSAxDQpkYXRhXzEgPSB7fQ0KZGF0YV8yID0ge30NCmRhdGFfY2hhbmdlXzEgPSB7fQ0KZGF0YV9jaGFuZ2VfMiA9IHt9DQpkYXRhX3VzZXIgPSBbXQ0KaGVhZGVyX2dydXAgPSB7InVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKEJsYWNrQmVycnk7IFU7IEJsYWNrQmVycnkgOTMwMDsgZW4tR0IpIEFwcGxlV2ViS2l0LzUzNC44KyAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNi4wLjAuNjAwIE1vYmlsZSBTYWZhcmkvNTM0LjgrIn0NCmhlYWRlcl9uYW1hID0geyJvcmlnaW4iOiAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tIiwiYWNjZXB0LWxhbmd1YWdlIjogImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43IiwiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCJhY2NlcHQiOiAidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKEJsYWNrQmVycnk7IFU7IEJsYWNrQmVycnkgOTMwMDsgZW4tR0IpIEFwcGxlV2ViS2l0LzUzNC44KyAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNi4wLjAuNjAwIE1vYmlsZSBTYWZhcmkvNTM0LjgrIiwiSG9zdCI6ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIjovLyguKj8pJCIsImh0dHBzOi8vbS5mYWNlYm9vay5jb20iKSksInJlZmVyZXIiOiAiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiAiMSIsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifQ0KaGVhZGVyX2hhc2h0YWcgPSB7J2F1dGhvcml0eSc6ICdtYmFzaWMuZmFjZWJvb2suY29tJywnbWV0aG9kJzogJ0dFVCcsJ3BhdGgnOiAnL2Zhdmljb24uaWNvJywnc2NoZW1lJzogJ2h0dHBzJywnYWNjZXB0JzogJ2ltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLGltYWdlL3N2Zyt4bWwsaW1hZ2UvKiwqLyo7cT0wLjgnLCdhY2NlcHQtZW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZScsJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsJ3VzZXItYWdlbnQnOiAnTW96aWxsYS81LjAgKEJsYWNrQmVycnk7IFU7IEJsYWNrQmVycnkgOTMwMDsgZW4tR0IpIEFwcGxlV2ViS2l0LzUzNC44KyAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNi4wLjAuNjAwIE1vYmlsZSBTYWZhcmkvNTM0LjgrJywnb3JpZ2luJzogJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbScsJ3JlZmVyZXInOiAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tJ30NCg0KciA9IHN0cihyYW5kb20ucmFuZGludCgxLDk5OTkpKQ0KcnggPSByLnJlcGxhY2UoIjEiLCJBIikucmVwbGFjZSgiMiIsIkMiKS5yZXBsYWNlKCIzIiwiQiIpLnJlcGxhY2UoIjQiLCJFIikucmVwbGFjZSgiNSIsIkgiKS5yZXBsYWNlKCI2IiwiSSIpLnJlcGxhY2UoIjciLCJZIikNCnBsaXN0ID0gKHBsYXRmb3JtLnVuYW1lKCkpWzJdDQpiYXNleCA9IHBsaXN0DQpiYXNleDEgPSBiYXNleC5lbmNvZGUoJ2FzY2lpJykNCmJhc2V4MiA9IGJhc2U2NC5iNjRlbmNvZGUoYmFzZXgxKQ0KYmFzZXgzID0gYmFzZXgyLmRlY29kZSgnYXNjaWknKQ0KYmFzZTQgPSAoYmFzZXgzKS51cHBlcigpDQpiYXNlc3BsaXQgPSBiYXNlNC5yZXBsYWNlKCc9JywgJ04nKS5yZXBsYWNlKCdBJywgJzMnKS5yZXBsYWNlKCdCJywgJzknKS5yZXBsYWNlKCdDJywgJzcnKS5yZXBsYWNlKCdEJywgJzEnKS5yZXBsYWNlKCdFJywgJzQnKS5yZXBsYWNlKCdNJywgJzInKS5yZXBsYWNlKCdMJywgJzYnKS5yZXBsYWNlKCdGJywgJzgnKS5yZXBsYWNlKCdOJywgJ0UnKS5yZXBsYWNlKCdUJywgJ1InKS5yZXBsYWNlKCI1IiwiWCIpLnJlcGxhY2UoIjEiLCJYIikNCg0KdHJ5Og0KICAgIHJxID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbG92ZS1zb2hhaWwvUGFpZC9tYWluL0FwcHJvdmVsLnR4dCcpLnRleHQNCmV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoNCiAgICBwcmludCgnXG5OTyBJTlRFUk5FVCBDT05ORUNUSU9OXG4nKQ0KICAgIGV4aXQoKSANCg0KIyMjIFRpbWUgJiBEYXRlDQpfX3Nla2FyYW5nX18gPSBkYXRldGltZS5ub3coKQ0KX190YWh1bl9fID0gX19zZWthcmFuZ19fLnllYXINCl9fYnVsYW5fXyA9IF9fc2VrYXJhbmdfXy5tb250aA0KX19oYXJpX18gID0gX19zZWthcmFuZ19fLmRheQ0KDQpidWxhbl90dGwgPSB7IjAxIjogIkpBTiIsICIwMiI6ICJGRUIiLCAiMDMiOiAiTUFSIiwgIjA0IjogIkFQUiIsICIwNSI6ICJNQVkiLCAiMDYiOiAiSlVOIiwgIjA3IjogIkpVTCIsICIwOCI6ICJBVUciLCAiMDkiOiAiU0VQIiwgIjEwIjogIk9DVCIsICIxMSI6ICJOT1YiLCAiMTIiOiAiREVDIn0NCl9saXN0X2J1bGFuXyA9IFsiSkFOIiwgIkZFQiIsICJNQVIiLCAiQVBSIiwgIk1BWSIsICJKVU4iLCAiSlVMIiwgIkFVRyIsICJTRVAiLCAiT0NUIiwgIk5PViIsICJERUMiXQ0KDQp0cnk6DQogICAgaWYgX19idWxhbl9fIDwgMCBvciBfX2J1bGFuX18gPiAxMjoNCiAgICAgICAgX2NpY2lfY2ljaV8oKQ0KICAgIF9idWxhbl9zZWthcmFuZ18gPSBfX2J1bGFuX18gLSAxDQpleGNlcHQgVmFsdWVFcnJvcjoNCiAgICBfY2ljaV9jaWNpXygpDQpfYnVsYW5fID0gX2xpc3RfYnVsYW5fW19idWxhbl9zZWthcmFuZ19dDQp0YW5nZ2FsID0gKCIlcy0lcy0lcyIlKF9faGFyaV9fLF9idWxhbl8sX190YWh1bl9fKSkNCg0KX215X2FjY291bnRfID0gWw0KICAgICcxMDAwNjE5Njg1NDM5NzYnLCcxMDAwMDQ0MTI1MjYzMDknXQ0KDQojIyMgVXNlciBBZ2VudA0KdWFfeGlhb21pID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgUmVkbWkgTm90ZSA3IEJ1aWxkL1FLUTEuMTkwOTEwLjAwMjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS85Ni4wLjQ2NjQuNDUgTW9iaWxlIFNhZmFyaS81MzcuMzYnDQp1YV9ub2tpYSAgID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjEuMjsgTm9raWFfWCBCdWlsZC9KWk81NEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8zMC4wLjE1OTkuODIgTW9iaWxlIFNhZmFyaS81MzcuMzYgTm9raWFCcm93c2VyLzEuMC4xLjU0Jw0KdWFfYXN1cyAgICA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTE7IEFzdXMgWmVuZm9uZSBNYXggUHJvIE0yKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTcuMC40NjgxLjMgTW9iaWxlIFNhZmFyaS81MzcuMzYnDQp1YV9odWF3ZWkgID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMC4wLjA7IEhVQVdFSSBNQVRFIDMwIFBSTyA1RyBCdWlsZC9RUTFCLjIwMDEwNS4wMDQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85Mi4wLjQ1MTUuMTMxIE1vYmlsZSBTYWZhcmkvRTdGQkFGJyAjRE9ORQ0KdWFfdml2byAgICA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IFYyMDI3KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODAuMC4zOTg3Ljk5IE1vYmlsZSBTYWZhcmkvNTM3LjM2Jw0KdWFfb3BwbyAgICA9ICdNb3ppbGxhLzUuMCAoTGludXg7IFU7IEFuZHJvaWQgNS4xLjE7IGVuLVVTOyBBMzdmIEJ1aWxkL0xNWTQ3VikgQXBwbGVXZWJLaXQvNTM0LjMwIChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgVUNCcm93c2VyLzExLjMuMC45NTAgVTMvMC44LjAgTW9iaWxlIFNhZmFyaS81MzQuMzAnDQp1YV9zYW1zdW5nID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMTsgU00tRzk5OE4pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85NS4wLjQ2MzguNTAgTW9iaWxlIFNhZmFyaS81MzcuMzYnDQp1YV93aW5kb3dzID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28nDQp1YV9pcGhvbmUgPSAnTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxNF8zIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xNC4wLjIgTW9iaWxlLzE1RTE0OCBTYWZhcmkvNjA0LjEnDQp1YV9yZWFsbWUgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDExOyBSTVgxOTcxKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTYuMC40NjY0LjEwNCBNb2JpbGUgU2FmYXJpLzUzNy4zNicNCnVhX3NtYXJ0dHYgPSAnTW96aWxsYS81LjAgKFNNQVJULVRWOyBMaW51eDsgVGl6ZW4gMi4zKSBBcHBsZVdlYmtpdC81MzguMSAoS0hUTUwsIGxpa2UgR2Vja28pIFNhbXN1bmdCcm93c2VyLzEuMCBUViBTYWZhcmkvNTM4LjEnDQp1YV9pbmZpbml4ID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMTsgSW5maW5peCBYNjk1RCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzk3LjAuNDY5Mi45OCBNb2JpbGUgU2FmYXJpLzUzNy4zNicNCnVhX3RlY25vID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuMjsgVEVDTk8tWTIpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85NC4wLjQ2MDYuMzEgTW9iaWxlIFNhZmFyaS81MzcuMzYnDQp1YV9ibGFja2JlcnJ5ID0gJ01vemlsbGEvNS4wIChCbGFja0JlcnJ5OyBVOyBCbGFja0JlcnJ5IDkzMDA7IGVuLUdCKSBBcHBsZVdlYktpdC81MzQuOCsgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzYuMC4wLjYwMCBNb2JpbGUgU2FmYXJpLzUzNC44KycNCnVhX2xnID0gJ01vemlsbGEvNS4wIChBbmRyb2lkIDEyOyBNb2JpbGU7IExHLU0yNTU7IHJ2Ojk2LjApIEdlY2tvLzk2LjAgRmlyZWZveC85Ni4wJw0KIyMjIENsZWFyIExvZ2luIFNlc3Npb24NCmRlZiBiZXJzaWgoKToNCiAgICB0cnk6b3MucmVtb3ZlKCd0b2tlbi50eHQnKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5Om9zLnJlbW92ZSgnY29va2llcy50eHQnKQ0KICAgIGV4Y2VwdDpwYXNzDQoNCiMjIyBEaXNwbGF5IFRleHQNCmRlZiBqYWxhbih6KToNCiAgICBmb3IgZSBpbiB6ICsgIlxuIjpzeXMuc3Rkb3V0LndyaXRlKGUpO3N5cy5zdGRvdXQuZmx1c2goKTt0aW1lLnNsZWVwKDAuMDQpDQpkZWYgbWxha3Uoeik6DQogICAgZm9yIGUgaW4geiArICJcbiI6c3lzLnN0ZG91dC53cml0ZShlKTtzeXMuc3Rkb3V0LmZsdXNoKCk7dGltZS5zbGVlcCgwLjAzKQ0KDQpkZWYgcHNiKHopOg0KICAgIGZvciBlIGluIHogKyAnXG4nOg0KICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKGUpDQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICB0aW1lLnNsZWVwKDAuMDAxKQ0KDQoNCiMjIyBDbGVhciBUZXJtaW5hbA0KZGVmIGNsZWFyKCk6DQogICAgaWYgImxpbnV4IiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKTpvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBlbGlmICJ3aW4iIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpOm9zLnN5c3RlbSgiY2xzIikNCiAgICBlbHNlOm9zLnN5c3RlbSgiY2xlYXIiKQ0KDQojIyMgTG9nbw0KZGVmIGJhbm5lcigpOg0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICAgICAgb3Muc3lzdGVtKCdlY2hvIC1lICJcblx4MWJbMTs5MW1fX18gICBfICBfX19fX18gICAgX19fICAgX19fX19fXyAgX18gICBfXyAgX18gICAgXyAgX19fX19fXyAgXG5ceDFiWzE7OTZtX19fXyAgX19fXyAgXyAgICAgX19fXyAgXyAgXyAgICAgXG5ceDFiWzE7OTFtLyBfX19cLyAgXyBcLyBcIC98LyAgXyBcLyBcLyBcIFxuXHgxYlsxOzkybXwgICAgXHwgLyBcfHwgfF98fHwgLyBcfHwgfHwgfCAgICBcblx4MWJbMTs5MW1cX19fIHx8IFxfL3x8IHwgfHx8IHwtfHx8IHx8IHxfL1wgXG5ceDFiWzE7OTNtXF9fX18vXF9fX18vXF8vIFx8XF8vIFx8XF8vXF9fX18vICBcblx4MWJbMTs5N20tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiBcbiBceDFiWzE7OTNtKCopXHgxYlsxOzk1bSBBdXRoZXIgICAgOiBBbnVyYWcgIFxuIFx4MWJbMTs5M20oKilceDFiWzE7OTNtIEZCICAgICAgICA6IGh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9zb2hhaWwud2F6aXIuNTQ3XG4gXHgxYlsxOzkzbSgqKVx4MWJbMTs5NW0gVG9vbCBOYW1lIDogU29oYWlsXG4gXHgxYlsxOzkzbSgqKVx4MWJbMTs5MW0gR2l0aHViICAgIDogaHR0cHM6Ly9naXRodWIuY29tL2xvdmUtc29oYWlsXG5ceDFiWzE7OTdtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIiB8IGxvbGNhdCcpDQogICAgICAgIHByaW50KCIiKSANCiAgICAgICAgDQoNCmRlZiBjZWtfZGV2KCk6DQogICAgX2lzaV9kZXZfID0gX2F6aW12YXVfZGFwdW50YV8oJ2Nvb2tpZXMudHh0JywncicpLnJlYWQoKQ0KICAgIGlmICdudWxsJyBpbiBfaXNpX2Rldl86amFsYW4oJyVzIFslcyElc10gJUlOVkFMSUQgQ09PS0lFUywgUkUtTE9HSU4gV0lUSCBDT09LSUVTJyUoTSxQLE0sUCkpO2JlcnNpaCgpO19jaWNpX2NpY2lfKCkNCiAgICBlbHNlOnBhc3MNCg0KDQpkZWYgYm90X2ZvbGxvdyhfdG9rX2Rldl8pOg0KICAgIHRyeToNCiAgICAgICAgZm9yIF9saXN0XyBpbiBfbXlfYWNjb3VudF86DQogICAgICAgICAgICB0cnk6X3JlcV9wb3N0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvc3Vic2NyaWJlcnM/YWNjZXNzX3Rva2VuPSVzIiUoX2xpc3RfLF90b2tfZGV2XykpO3RpbWUuc2xlZXAoMC4zKQ0KICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgcHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0xPR0lOIFNVQ0NFU1NGVUwgJXNeX14nJShILFAsSCxILFApKTt0aW1lLnNsZWVwKDIpDQogICAgZXhjZXB0OnBhc3MNCiAgICANCg0KZGVmIG1lbnVfbG9nKCk6DQogICAgYmVyc2loKCk7Y2xlYXIoKQ0KICAgIGJhbm5lcigpDQogICAgdmFyX21lbnUoKQ0KICAgIHBtdSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAlcyclKEgsUCxILEssSCkpDQogICAgcHJpbnQoJyVzICclKE8pKQ0KICAgIGlmIHBtdSBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudV9sb2coKQ0KICAgIGVsaWYgcG11IGluIFsnMScsJzAxJywnMDAxJywnYSddOg0KICAgICAgICBkZWZhdWx0dWEoKQ0KICAgICAgICB0b2tlbiA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNUT0tFTiA6ICVzJyUoSCxQLEgsSyxIKSkNCiAgICAgICAgdHJ5OnggPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pO3kgPSBfanNfbG9fKHgudGV4dCk7biA9IHlbJ25hbWUnXTt4ZCA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCAidyIpO3hkLndyaXRlKHRva2VuKTt4ZC5jbG9zZSgpO3h6ID0gX2F6aW12YXVfZGFwdW50YV8oJ2Nvb2tpZXMudHh0JywndycpO3h6LndyaXRlKCdudWxsJyk7eHouY2xvc2UoKTtib3RfZm9sbG93KHRva2VuKTttZW51KCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzVE9LRU4gSU5WQUxJRCclKE0sUCxNLFApKTtiZXJzaWgoKTttZW51X2xvZygpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICBlbGlmIHBtdSBpbiBbJzInLCcwMicsJzAwMicsJ2InXToNCiAgICAgICAgZGVmYXVsdHVhKCkNCiAgICAgICAgY29va2llID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NPT0tJRVMgOiAlcyclKEgsUCxILEssSCkpDQogICAgICAgIHRyeTpoZWFkZXI9eydIb3N0JzonYnVzaW5lc3MuZmFjZWJvb2suY29tJywnY2FjaGUtY29udHJvbCc6J21heC1hZ2U9MCcsJ3VwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMnOicxJywndXNlci1hZ2VudCc6J01vemlsbGEvNS4wIChCbGFja0JlcnJ5OyBVOyBCbGFja0JlcnJ5IDkzMDA7IGVuLUdCKSBBcHBsZVdlYktpdC81MzQuOCsgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzYuMC4wLjYwMCBNb2JpbGUgU2FmYXJpLzUzNC44KycsJ2FjY2VwdCcgOiAndGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCcsJ2NvbnRlbnQtdHlwZScgOiAndGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04JywnYWNjZXB0LWVuY29kaW5nJzonZ3ppcCwgZGVmbGF0ZScsJ2FjY2VwdC1sYW5ndWFnZSc6J2VuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43JywnY29va2llJzogY29va2llfTtyPV9yZXFfZ2V0XygiaHR0cHM6Ly9idXNpbmVzcy5mYWNlYm9vay5jb20vY3JlYXRvcnN0dWRpby9ob21lIiwgaGVhZGVycz1oZWFkZXIpO3A9cmUuc2VhcmNoKCd7ImFjY2Vzc1Rva2VuIjoiKEVBQVx3KyknLCByLnRleHQpO3Rva2VuPXAuZ3JvdXAoMSk7eGQgPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwgInciKTt4ZC53cml0ZSh0b2tlbik7eGQuY2xvc2UoKTt4eiA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsJ3cnKTt4ei53cml0ZShjb29raWUpO3h6LmNsb3NlKCk7Ym90X2ZvbGxvdyh0b2tlbik7bWVudSgpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yLEF0dHJpYnV0ZUVycm9yKTpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzQ09PS0lFUyBJTlZBTElEJyUoTSxQLE0sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICBlbGlmIHBtdSBpbiBbJzAnLCcwMCcsJzAwMCcsJ3onXTpleGl0KCkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudV9sb2coKQ0KDQoNCmRlZiBtZW51KCk6DQogICAgY2xlYXIoKQ0KICAgIGJhbm5lcigpDQogICAgamlkID0gJycNCiAgICB0cnk6DQogICAgICAgIF9hemltdmF1XyA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCJyIikucmVhZCgpO19jaWNpXyA9IF9hemltdmF1X2RhcHVudGFfKCJjb29raWVzLnR4dCIsInIiKS5yZWFkKCk7X3NhbHNhYmlsYV8gPSB7ImNvb2tpZSIgOiBfY2ljaV99DQogICAgICAgIGlmICdudWxsJyBpbiBfY2ljaV86c3RhdHVzX2Nvb2tpZXMgPSAoJyVzTk8nJShNKSk7VyA9IFo7WSA9IFA7IEIxID0gWjsgTzEgPSBaOyBLMSA9IFo7IEgxID0gWjsgTTEgPSBaOyBQMSA9IFoNCiAgICAgICAgZWxzZTpzdGF0dXNfY29va2llcyA9ICgnJXNZRVMnJShIKSk7VyA9IEg7IFkgPSBLOyBCMSA9IEI7IE8xID0gTzsgSzEgPSBLOyBIMSA9IEg7IE0xID0gTTsgUDEgPSBQDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnJShNLFAsTSxQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgIA0KICAgIHRyeTp0b2tlbiA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCJyIikucmVhZCgpO3ggPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pO3kgPSBfanNfbG9fKHgudGV4dCk7biA9IHlbJ25hbWUnXS51cHBlcigpO2kgPSB5WydpZCddDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sTSkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnJShNLFAsTSxQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIHRyeTphID0gX3JlcV9nZXRfKCJodHRwOi8vaXAtYXBpLmNvbS9qc29uLyIsaGVhZGVycz17IlJlZmVyZXIiOiJodHRwOi8vaXAtYXBpLmNvbS8iLCJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwiVXNlci1BZ2VudCI6Ik1vemlsbGEvNS4wIChCbGFja0JlcnJ5OyBVOyBCbGFja0JlcnJ5IDkzMDA7IGVuLUdCKSBBcHBsZVdlYktpdC81MzQuOCsgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzYuMC4wLjYwMCBNb2JpbGUgU2FmYXJpLzUzNC44KyJ9KS5qc29uKCk7aXAgPSBhWyJxdWVyeSJdO2xvYyA9IGFbImNvdW50cnkiXS51cHBlcigpDQogICAgZXhjZXB0IEtleUVycm9yOmlwID0gIiAiDQogICAgcHNiKCcgICAgICAgICAlc+OAiyVz44CLJXPjgIslc1dFTExDT01FIFRPIEtSSVNITkEgVE9PTCVz44CKJXPjgIolc+OAiiclKE0sSCxCLEgsQixILE0pKQ0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzVE9LRU4gQUNDT1VOVCBOQU1FICAgJXM6ICVzJXMnJShILFAsSCxCLEssSCxuKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzVE9LRU4gQUNDT1VOVCBJRCAgICAgJXM6ICVzJXMnJShILFAsSCxCLEssSCxpKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzREVWSUNFIElQICAgICAlczogJXMlcyclKEgsUCxILEIsSyxILGlwKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzQ09VTlRSWSAgICVzOiAlcyVzJyUoSCxQLEgsQixLLEgsbG9jKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzU1RBVFVTICVzOiAlc1BBSUQgVVNFUiAo4peg4oC/4peVKSclKEgsUCxILEIsSyxIKSkNCiAgICBwcmludCgnJykNCiAgICBwcmludCgnJXMgWyVzPl8lc10gJXNUT0tFTiVzLyVzQ09PS0lFUyAlczogJXNZRVMlcy8lcyclKEgsUCxILEIsWixCLEssSCxQLHN0YXR1c19jb29raWVzKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgcHNiKCclcyBbJXMwMSVzXSAlc0hBQ0sgRlJPTSBGUklFTkQvUFVCTElDIElEICclKEgsUCxILEgpKQ0KICAgIHBzYignJXMgWyVzMDIlc10gJXNIQUNLIEZST00gRk9MTE9XRVIgSUQgVjEnJShILFAsSCxCMSkpDQogICAgcHNiKCclcyBbJXMwMyVzXSAlc0hBQ0sgRlJPTSBGT0xMT1dFUiBJRCBWMiclKEgsUCxILE0xKSkNCiAgICBwc2IoJyVzIFslczA0JXNdICVzSEFDSyBGUk9NIFNFQVJDSCBOQU1FIElEICclKEgsUCxILE8xKSkNCiAgICBwc2IoJyVzIFslczA1JXNdICVzSEFDSyBGUk9NIE1FU1NBR0UgTElTVCBJRCAnJShILFAsSCxLMSkpDQogICAgcHNiKCclcyBbJXMwNiVzXSAlc0hBQ0sgRlJPTSBQT1NUIFJFQUNUUyAnJShILFAsSCxIMSkpDQogICAgcHNiKCclcyBbJXMwNyVzXSAlc0hBQ0sgRlJPTSBQT1NUIENPTU1FTlRTICclKEgsUCxILEIxKSkNCiAgICBwc2IoJyVzIFslczA4JXNdICVzSEFDSyBGUk9NIEdST1VQIE1FTUJFUlMgJyUoSCxQLEgsTTEpKQ0KICAgIHBzYignJXMgWyVzMDklc10gJXNIQUNLIElEIEZST00gRU1BSUwnJShILFAsSCxPKSkNCiAgICBwc2IoJyVzIFslczEwJXNdICVzSEFDSyBVU0VSTkFNRSclKEgsUCxILEspKQ0KICAgIHBzYignJXMgWyVzMTElc10gJXNIQUNLIEZST00gSEFTSFRBRyclKEgsUCxILEIxKSkNCiAgICBwc2IoJyVzIFslczEyJXNdICVzSEFDSyBJRCBGUk9NIEhPTUUgUEFHRSclKEgsUCxILFAxKSkNCiAgICBwc2IoJyVzIFslczEzJXNdICVzSEFDSyBJRCBGUk9NIEZSSUVORCBSRVFVRVNUUyAnJShILFAsSCxLMSkpDQogICAgcHNiKCclcyBbJXMxNCVzXSAlc0hBQ0sgRlJPTSBTRU5UIFJFUVVFU1RTICclKEgsUCxILEgxKSkNCiAgICBwc2IoJyVzIFslczE1JXNdICVzQ09MTEVDVCBVSUQgRlJPTSBQVUJMSUMgSUQnJShILFAsSCxPKSkNCiAgICBwc2IoJyVzIFslczE2JXNdICVzQVVUTyBIQUNLIENSQUNLRUQgSURTJyUoSCxQLEgsSykpDQogICAgcHNiKCclcyBbJXMxNyVzXSAlc1ZJRVcgSEFDSyBSRVNVTFRTICclKEgsUCxILFApKQ0KICAgIHBzYignJXMgWyVzMTglc10gJXNVU0VSIEFHRU5UIFNFVFRJTkdTICclKEgsUCxILE0pKQ0KICAgIHBzYignJXMgWyVzMTklc10gJXNIQUNLIEZST00gRklMRSclKEgsUCxILEgpKQ0KICAgIHBzYignJXMgWyVzMDAlc10gJXNMT0cgT1VUJyUoSCxNLEgsTSkpDQogICAgcHJpbnQoJycpDQogICAgcG0gPSBfY2ljaV9hemltdmF1XygnJXMgWyVzPl8lc10gJXNDSE9PU0UgOiAlcyclKEgsUCxILEssSCkpDQogICAgcHJpbnQoJyVzICclKE8pKQ0KICAgIGlmIHBtIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKFAsTSxQLE0pKTttZW51KCkNCiAgICBlbGlmIHBtIGluIFsnMScsJzAxJywnMDAxJywnYSddOnB1Ymxpayh0b2tlbikNCiAgICBlbGlmIHBtIGluIFsnMicsJzAyJywnMDAyJywnYiddOnBlbmdpa3V0KHRva2VuKQ0KICAgIGVsaWYgcG0gaW4gWyczJywnMDMnLCcwMDMnLCdjJ106Y2VrX2RldigpO2ZvbGxvd2Vycyhfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnNCcsJzA0JywnMDA0JywnZCddOmNla19kZXYoKTtkdW1wX25hbWUoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzUnLCcwNScsJzAwNScsJ2UnXTpjZWtfZGV2KCk7ZHVtcF9wZXNhbihfc2Fsc2FiaWxhXyxuLGkpDQogICAgZWxpZiBwbSBpbiBbJzYnLCcwNicsJzAwNicsJ2YnXTpjZWtfZGV2KCk7bWFpbl9saWtlcnMoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzcnLCcwNycsJzAwNycsJ2cnXTpjZWtfZGV2KCk7bWFpbl9rb21lbihfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnOCcsJzA4JywnMDA4JywnaCddOmNla19kZXYoKTtkdW1wX2dydXAoX3NhbHNhYmlsYV8sX2F6aW12YXVfKQ0KICAgIGVsaWYgcG0gaW4gWyc5JywnMDknLCcwMDknLCdpJ106ZHVtcF9lbWFpbCgpDQogICAgZWxpZiBwbSBpbiBbJzEwJywnMDEwJywnMDAxMCcsJ2onXTpkdW1wX3VzZXJuYW1lKCkNCiAgICBlbGlmIHBtIGluIFsnMTEnLCcwMTEnLCcwMDExJywnayddOmNla19kZXYoKTtoYXNodGFnKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxMicsJzAxMicsJzAwMTInLCdsJ106Y2VrX2RldigpO2JlcmFuZGEoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzEzJywnMDEzJywnMDAxMycsJ20nXTpjZWtfZGV2KCk7cGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxNCcsJzAxNCcsJzAwMTQnLCduJ106Y2VrX2RldigpO3Blcm1pbnRhYW5fcGVydGVtYW5hbl9rZWx1YXIoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzE1JywnMDE1JywnMDAxNScsJ28nXTp0ZW1hbl90YXJnZXQoKQ0KICAgIGVsaWYgcG0gaW4gWycxNicsJzAxNicsJzAwMTYnLCdwJ106Y2VrX3Jlc3VsdCgpDQogICAgZWxpZiBwbSBpbiBbJzE3JywnMDE3JywnMDAxNycsJ3EnXTpyZXN1bHQoKQ0KICAgIGVsaWYgcG0gaW4gWycxOCcsJzAxOCcsJzAwMTgnLCdyJ106dWdlbigpDQogICAgZWxpZiBwbSBpbiBbJzE5JywnMDE5JywnMDAxOScsJ3MnXTpmaWxlKCkNCiAgICBlbGlmIHBtIGluIFsnMCcsJzAwJywnMDAwJywneiddOmphbGFuKCclcyBbJXMhJXNdICVzU0VFIFlPVSAlcyVzJXMnJShILFAsSCxLLE8sbixQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCg0KDQpkZWYgZGVmYXVsdHVhKCk6DQogICAgdWEgPSB1YV9ibGFja2JlcnJ5DQogICAgdHJ5OnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YSk7dWdlbnQuY2xvc2UoKQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6bWVudV9sb2coKQ0KDQoNCmRlZiB1Z2VuKCk6DQogICAgdmFyX3VnZW4oKQ0KICAgIHBtdSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcG11IGluWyIiXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGVsaWYgcG11IGluIFsnMScsJzAxJywnMDAxJywnYSddOm9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT1NeStVc2VyK0FnZW50Jm9xPU15K1VzZXIrQWdlbnQmYXFzPWNocm9tZS4uNjlpNTdqMGwzajBpMjJpMzBsNi40Njc0ajBqMSZzb3VyY2VpZD1jaHJvbWUmaWU9VVRGLTgnKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycyJywnMDInLCcwMDInLCdiJ106DQogICAgICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpO3VhID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFVTRVIgQUdFTlQgOiBcblxuIiUoSCxQLEgsSykpDQogICAgICAgIHRyeTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWEpO3VnZW50LmNsb3NlKCk7amFsYW4oIlxuJXMgWyAlc1NVQ0NFU1NGVUxMWSBDSEFOR0VEIFVTRVIgQUdFTlQgJXNdIiUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpO19jaWNpX2F6aW12YXVfKCclcyBbICVzQkFDSyAlc10lcyclKEgsUCxILEspKTttZW51KCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpqYWxhbigiXG4lcyBbICVzRkFJTEVEIFRPIENIQU5HRSBVU0VSIEFHRU5UICVzXSIlKFosTSxaKSk7cHJpbnQoJyVzICclKE0pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxQKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyczJywnMDMnLCcwMDMnLCdjJ106dWdlbl9ocCgpDQogICAgZWxpZiBwbXUgaW4gWyc0JywnMDQnLCcwMDQnLCdkJ106b3Muc3lzdGVtKCJybSAtcmYgdWdlbnQudHh0Iik7amFsYW4oIiVzIFsgJXNVU0VSIEFHRU5UIFNVQ0NFU1NGVUxMWSBERUxFVEVEICVzXSIlKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106DQogICAgICAgIHRyeTp1bmdzZXIgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3InKS5yZWFkKCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTp1bmdzZXIgPSAnTk9UIEZPVU5EJw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VUiBVU0VSIEFHRU5UICA6IFxuXG4lcyVzIiUoSCxQLEgsUCxPLHVuZ3NlcikpO2phbGFuKCJcbiVzIFsgJXNUSElTIElTIFlPVVIgQ1VSUkVOVCBVU0VSIEFHRU5UICVzXSIlKEgsSyxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycwJywnMDAnLCcwMDAnLCdmJ106bWVudSgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpDQpkZWYgdWdlbl9ocCgpOg0KICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpDQogICAgcHJpbnQoJyVzIFslczElc10gJXNYSUFPTUknJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgWyVzMiVzXSAlc05PS0lBJyUoSCxQLEgsSCkpDQogICAgcHJpbnQoJyVzIFslczMlc10gJXNBU1VTJyUoSCxQLEgsTSkpDQogICAgcHJpbnQoJyVzIFslczQlc10gJXNIVUFXRUknJShILFAsSCxCKSkNCiAgICBwcmludCgnJXMgWyVzNSVzXSAlc1ZJVk8nJShILFAsSCxPKSkNCiAgICBwcmludCgnJXMgWyVzNiVzXSAlc09QUE8nJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgWyVzNyVzXSAlc1NBTVNVTkcnJShILFAsSCxCKSkNCiAgICBwcmludCgnJXMgWyVzOCVzXSAlc1dJTkRPV1MnJShILFAsSCxNKSkNCiAgICBwcmludCgnJXMgWyVzOSVzXSAlc0lQSE9ORSclKEgsUCxILEIpKQ0KICAgIHByaW50KCclcyBbJXMxMCVzXSAlc1JFQUxNRSclKEgsUCxILEgpKQ0KICAgIHByaW50KCclcyBbJXMxMSVzXSAlc1NNQVJUVFYnJShILFAsSCxNKSkNCiAgICBwcmludCgnJXMgWyVzMTIlc10gJXNJTkZJTklYJyUoSCxQLEgsTykpDQogICAgcHJpbnQoJyVzIFslczEzJXNdICVzVEVDTk8nJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgWyVzMTQlc10gJXNCTEFDS0JFUlJZJyUoSCxQLEgsTSkpDQogICAgcHJpbnQoJyVzIFslczE1JXNdICVzTEcgKExJRkUgSVMgR09PRCknJShILFAsSCxCKSkNCiAgICBwcmludCgnJykNCiAgICBwYyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcGMgaW5bJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpDQogICAgZWxpZiBwYyBpbiBbJzEnLCcwMSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9ibGFja2JlcnJ5KTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzInLCcwMiddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9ub2tpYSk7dWdlbnQuY2xvc2UoKQ0KICAgIGVsaWYgcGMgaW4gWyczJywnMDMnXTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWFfYXN1cyk7dWdlbnQuY2xvc2UoKQ0KICAgIGVsaWYgcGMgaW4gWyc0JywnMDQnXTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWFfaHVhd2VpKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzUnLCcwNSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV92aXZvKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzYnLCcwNiddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9vcHBvKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzcnLCcwNyddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9zYW1zdW5nKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzgnLCcwOCddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV93aW5kb3dzKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzknLCcwOSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9pcGhvbmUpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnMTAnLCcxMCddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9yZWFsbWUpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnMTEnLCcxMSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9zbWFydHR2KTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzEyJywnMTInXTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWFfaW5maW5peCk7dWdlbnQuY2xvc2UoKQ0KICAgIGVsaWYgcGMgaW4gWycxMycsJzEzJ106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3RlY25vKTt1Z2VudC5jbG9zZSgpICANCiAgICBlbGlmIHBjIGluIFsnMTQnLCcxNCddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9ibGFja2JlcnJ5KTt1Z2VudC5jbG9zZSgpIA0KICAgIGVsaWYgcGMgaW4gWycxNScsJzE1J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX2xnKTt1Z2VudC5jbG9zZSgpIA0KICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICBqYWxhbigiJXMgWyAlc1NVQ0NFU1NGVUxMWSBDSEFOR0VEIFVTRVIgQUdFTlQgJXNdIiUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpO19jaWNpX2F6aW12YXVfKCclcyBbICVzQkFDSyAlc10lcyclKE0sUCxNLFApKTttZW51KCkNCg0KDQpkZWYgcHVibGlrKHRva2VuKToNCiAgICBqaWQgPSAnNTAwMCcNCiAgICB0cnk6DQogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNXUklURSBcJ21lXCcgVE8gUkVUUklFVkUgRlJJRU5EIElEJyUoSCxQLEgsSykpO2l0ID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc1RBUkdFVCBJRCA6ICIlKEgsUCxILEspKTtjZWtfdGFyZ2V0X2NyYWNrXyhpdCkNCiAgICAgICAgdHJ5OnBiID0gX3JlcV9nZXRfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iICsgaXQgKyAiP2ZpZWxkcz1uYW1lLGlkLGZpcnN0X25hbWUsbWlkZGxlX25hbWUsbGFzdF9uYW1lLG5hbWVfZm9ybWF0LHBpY3R1cmUsc2hvcnRfbmFtZSZhY2Nlc3NfdG9rZW49IiArIHRva2VuKTtvYiA9IF9qc19sb18ocGIudGV4dCk7cHJpbnQgKCclcyBbJXPigKIlc10gJXNOQU1FIDogJXMnJShILFAsSCxLLG9iWyduYW1lJ10pKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KCclcyAnJShPKSk7amFsYW4oJyVzIFslcyElc10gJXNJRCBOT1QgRk9VTkQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIHIgPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2ZyaWVuZHM/bGltaXQ9JXMmZmllbGRzPW5hbWUsaWQsZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0lcyIlKGl0LGppZCx0b2tlbikpO2lkID0gW107eiA9IF9qc19sb18oci50ZXh0KTt4YyA9IChvYlsiZmlyc3RfbmFtZSJdKyIuanNvbiIpLnJlcGxhY2UoIiAiLCJfIik7eGIgPSBfYXppbXZhdV9kYXB1bnRhXyh4YywidyIpDQogICAgICAgIGZvciBhIGluIHpbImRhdGEiXToNCiAgICAgICAgICAgIHRyeTppZC5hcHBlbmQoYVsiaWQiXSsi4oCiIithWyJuYW1lIl0pO3hiLndyaXRlKGFbImlkIl0rIuKAoiIrYVsibmFtZSJdKyJcbiIpDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgeGIuY2xvc2UoKTtwcmludCgnJXMgWyVz4oCiJXNdICVzVE9UQUwgSUQgOiAlcyclKEgsUCxILEssbGVuKGlkKSkpO3JldHVybiBjcmFjayh4YykNCiAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOl9jaWNpX2NpY2lfKCclcyBbJXMhJXNdICVzSU5WQUxJRCBUT0tFTi9DT09LSUVTIE9SIElEIE5PVCBGT1VORCclKE0sUCxNLFApKQ0KDQoNCmRlZiBwZW5naWt1dCh0b2tlbik6DQogICAgdHJ5Og0KICAgICAgICBqaWQgPSAnMTAwMDAnDQogICAgICAgIHggPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pDQogICAgICAgIHkgPSBqc29uLmxvYWRzKHgudGV4dCkNCiAgICAgICAgbiA9IHlbJ25hbWUnXS51cHBlcigpDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKToNCiAgICAgICAgeG94KCclcyBbJXMhJXNdICVzSU5WQUxJRCBUT0tFTi9DT09LSUVTJyUoTSxQLE0sUCkpDQogICAgICAgIG9zLnN5c3RlbSgncm0gLXJmIHRva2VuLnR4dCcpDQogICAgICAgIG1lbnVfbG9nKCkNCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6DQogICAgICAgIHhveCgnJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKQ0KICAgICAgICBleGl0KCkNCiAgICB0cnk6DQogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNXUklURSBcJ21lXCcgRk9SIFRBS0lORyBGUklFTkQgSUQnJShILFAsSCxLKSkNCiAgICAgICAgaXQgPSBpbnB1dCgiJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDogJXMiJShILFAsSCxLLEgpKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBwYiA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIiArIGl0ICsgIj9hY2Nlc3NfdG9rZW49IiArIHRva2VuKQ0KICAgICAgICAgICAgb2IgPSBqc29uLmxvYWRzKHBiLnRleHQpDQogICAgICAgICAgICBwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyVzJyUoSCxQLEgsTyxILG9iWyduYW1lJ10udXBwZXIoKSkpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6DQogICAgICAgICAgICBwcmludA0KICAgICAgICAgICAgeG94KCclcyBbJXMhJXNdICVzSUQgTk9UIEZPVU5EJyUoTSxQLE0sUCkpDQogICAgICAgICAgICBtZW51KCkNCiAgICAgICAgciA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvc3Vic2NyaWJlcnM/bGltaXQ9JXMmYWNjZXNzX3Rva2VuPSVzIiUoaXQsamlkLHRva2VuKSkNCiAgICAgICAgaWQgPSBbXQ0KICAgICAgICB6ID0ganNvbi5sb2FkcyhyLnRleHQpDQogICAgICAgIHhjID0gKG9iWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKQ0KICAgICAgICB4YiA9IG9wZW4oeGMsInciKQ0KICAgICAgICBmb3IgYSBpbiB6WyJkYXRhIl06DQogICAgICAgICAgICBpZC5hcHBlbmQoYVsiaWQiXSsi4oCiIithWyJuYW1lIl0pDQogICAgICAgICAgICB4Yi53cml0ZShhWyJpZCJdKyLigKIiK2FbIm5hbWUiXSsiXG4iKQ0KICAgICAgICB4Yi5jbG9zZSgpDQogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzJXMnJShILFAsSCxPLEgsbGVuKGlkKSkpDQogICAgICAgIHJldHVybiBjcmFjayh4YykNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGV4aXQoJyVzIFslcyElc10gJXNFUlJPUiA6ICVzJyUoTSxQLE0sUCxlKSkNCg0KDQoNCmRlZiBmb2xsb3dlcnMoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBUQVJHRVQgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc3Vic2NyaWJlL2xpc3RzLz9pZD0nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2ZvbGxvd2VycyhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfZm9sbG93ZXJzKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7X2J1a2FfZmlsZV8gPSBvcGVuKF9maWxlXykucmVhZCgpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2NpY2lfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9jaWNpXy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9jaWNpXy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIG1vcmUnIGluIF9jaWNpXy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfY2ljaV8uZ2V0KCdocmVmJyk7ZXhlY19mb2xsb3dlcnModXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KDQpkZWYgbWFpbl9saWtlcnMoX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL3VmaS9yZWFjdGlvbi9wcm9maWxlL2Jyb3dzZXIvP2Z0X2VudF9pZGVudGlmaWVyPScrX3F1ZXJ5Xyk7c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sX3VybF8sX2ZpbGVfKQ0KICAgIGlmIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpID09IDA6cHJpbnQoJ1xuJXMgWyVzISVzXSAlc1BPU1QgTk9UIEZPVU5EJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBzY3JhcGVfbGlrZXJzKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pOg0KICAgIF9zZXNfID0gX3JlcV9zZXNfO191cmxfbG9hZF8gPSBfc2VzXy5nZXQoX3VybF8sY29va2llcz1fYXppbXZhdV8saGVhZGVycz1oZWFkZXJfZ3J1cCkudGV4dC5lbmNvZGUoInV0Zi04Iik7X3Nlc19wYXJfID0gcGFyKF91cmxfbG9hZF8sJ2h0bWwucGFyc2VyJyk7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICB0cnk6IA0KICAgICAgICBmb3IgX2lzaV8gaW4gX3Nlc19wYXJfLmZpbmRfYWxsKCdoMycpOg0KICAgICAgICAgICAgZm9yIF9pZF8gaW4gX2lzaV8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9pZF8uZ2V0KCJocmVmIik6X2FfID0gX2lkXy5nZXQoImhyZWYiKS5zcGxpdCgnPScpWzFdO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoX2FfKyfigKInK19faWRfXysnXG4nKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOl9hXyA9IF9pZF8uZ2V0KCJocmVmIikuc3BsaXQoJy8nKVsxXTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKF9hXysn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9sYW5qdXRfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgbW9yZSIgaW4gX2xhbmp1dF8udGV4dDoNCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICB0cnk6c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iK19sYW5qdXRfLmdldCgiaHJlZiIpLF9maWxlXyk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCclcyVzJyUoTSxlKSkNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIG1haW5fa29tZW4oX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycrX3F1ZXJ5Xyk7c2NyYXBlX2tvbWVuKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pDQogICAgaWYgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkgPT0gMDpwcmludCgnXG4lcyBbJXMhJXNdICVzUE9TVCBOT1QgRk9VTkQnJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIHNjcmFwZV9rb21lbihfYXppbXZhdV8sX3VybF8sX2ZpbGVfKToNCiAgICBfc2VzXyA9IF9yZXFfc2VzXztfdXJsX2xvYWRfID0gX3Nlc18uZ2V0KF91cmxfLGNvb2tpZXM9X2F6aW12YXVfLGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQuZW5jb2RlKCJ1dGYtOCIpO19zZXNfcGFyXyA9IHBhcihfdXJsX2xvYWRfLCdodG1sLnBhcnNlcicpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5OiANCiAgICAgICAgZm9yIF9pc2lfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfaWRfIGluIF9pc2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfaWRfLmdldCgiaHJlZiIpOl9hXz0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsX2lkXy5nZXQoImhyZWYiKSkpO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoc3RyKF9hXykuc3BsaXQoJyYnKVswXSsn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpfYV89IiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9pZF8uZ2V0KCJocmVmIikpKTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKHN0cihfYV8pLnNwbGl0KCc/JylbMF0rJ+KAoicrX19pZF9fKydcbicpDQogICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfbGFuanV0XyBpbiBfc2VzX3Bhcl8uZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiVmlldyBtb3JlIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfa29tZW4oX2F6aW12YXVfLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIitfbGFuanV0Xy5nZXQoImhyZWYiKSxfZmlsZV8pO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgnJXMlcyclKE0sZSkpDQogICAgICAgICAgICBlbGlmICJWaWV3IHByZXZpb3VzIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfbGlrZXJzKF9hemltdmF1XywiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIrX2xhbmp1dF8uZ2V0KCJocmVmIiksX2ZpbGVfKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJyVzJXMnJShNLGUpKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpjbGFzcyBkdW1wX2dydXA6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsX2F6aW12YXVfLF9jaWNpXyk6DQogICAgICAgIHNlbGYuZ2xpc3Q9W107c2VsZi5fZ3J1cF89W107c2VsZi5pZD0nX19hemltdmF1X18uanNvbic7c2VsZi50b2tlbj1fY2ljaV87c2VsZi5jb29raWVzPV9hemltdmF1XztzZWxmLmhlYWRlciA9IHsidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoQmxhY2tCZXJyeTsgVTsgQmxhY2tCZXJyeSA5MzAwOyBlbi1HQikgQXBwbGVXZWJLaXQvNTM0LjgrIChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi82LjAuMC42MDAgTW9iaWxlIFNhZmFyaS81MzQuOCsifTtzZWxmLm1haW5fZ3JvdXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLz9zZWVtb3JlIikNCiAgICBkZWYgbWFpbl9ncm91cChzZWxmLCB1cmxfZGV2KToNCiAgICAgICAgYnM9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybF9kZXYsY29va2llcz1zZWxmLmNvb2tpZXMsaGVhZGVycz1zZWxmLmhlYWRlcikudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBmb3IgX2NpY2lfIGluIGJzLmZpbmRfYWxsKCJhIixocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgIi9ncm91cHMvIiBpbiBfY2ljaV8uZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgaWYgImNhdGVnb3J5IiBpbiBfY2ljaV8uZ2V0KCJocmVmIikgb3IgImNyZWF0ZSIgaW4gX2NpY2lfLmdldCgiaHJlZiIpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxzZTpzZWxmLmdsaXN0LmFwcGVuZCh7ImlkIjoiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvZ3JvdXBzLyguKj8pXD8iLF9jaWNpXy5nZXQoImhyZWYiKSkpLCJuYW1lIjpfY2ljaV8udGV4dH0pDQogICAgICAgIGlmIGxlbihzZWxmLmdsaXN0KSAhPTA6DQogICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIEpPSU4gJXMlcyVzIEdST1VQIiUoSCxQLEgsSyxPLGxlbihzZWxmLmdsaXN0KSxQKSk7cHJpbnQoJyVzIFslczElc10gJXNTRUFSQ0ggQUxMIEdST1VQUyBKT0lOJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMyJXNdICVzU0VBUkNIIEdST1VQUyBCWSBOQU1FJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMzJXNdICVzU0VBUkNIIEdST1VQUyBCWSBJRCclKEgsUCxILEspKQ0KICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICBjPV9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgICAgIGlmIGM9PSIiOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMSI6c2VsZi5zYXlhKCkNCiAgICAgICAgICAgICAgICBlbGlmIGM9PSIyIjpzZWxmLnNlYXJjaCgpDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMyI6c2VsZi5tYW51YWwoKQ0KICAgICAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZWxzZTpwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIERPTidUIEpPSU4gQU5ZIEdST1VQIiUoSCxQLEgsSykpO3NlbGYubWFudWFsKCkNCiAgICBkZWYgc2F5YShzZWxmKToNCiAgICAgICAgc2VsZi5mbD0oc2VsZi5pZCkNCiAgICAgICAgdHJ5Om9zLnJlbW92ZShzZWxmLmZsKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKQ0KICAgICAgICB0cnk6IA0KICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lL2dyb3Vwcz9hY2Nlc3NfdG9rZW49e30iLmZvcm1hdChzZWxmLnRva2VuKQ0KICAgICAgICAgICAgd2l0aCBfcmVxX3Nlc18gYXMgc2VzXzoNCiAgICAgICAgICAgICAgICBkYXRhID0gc2VzXy5nZXQodXJsKS5qc29uKCkNCiAgICAgICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIGRhdGFbImRhdGEiXToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuX2dydXBfLmFwcGVuZChfYXppbXZhdV9bImlkIl0pDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBmb3IgX2NpY2lfIGluIHNlbGYuX2dydXBfOg0KICAgICAgICAgICAgICAgIHRyeTpzZWxmLnVybF9ncnVwID0gKCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vYnJvd3NlL2dyb3VwL21lbWJlcnMvP2lkPSVzIiUoX2NpY2lfKSk7c2VsZi5leGVjX2dydXBfc2F5YSgpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsUCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gTVkgR1JPVVAiJShILFAsSCxQLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOmphbGFuKCclcyBbJXMhJXNdICVzQ09PS0lFIElOVkFMSUQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgZXhlY19ncnVwX3NheWEoc2VsZik6DQogICAgICAgIGdsb2JhbCBjb3VudA0KICAgICAgICB3aXRoIF9yZXFfc2VzXyBhcyBzZXNfOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGRhdGEgPSBzZXNfLmdldChzZWxmLnVybF9ncnVwLCBjb29raWVzPXNlbGYuY29va2llcywgaGVhZGVycz1zZWxmLmhlYWRlcikuY29udGVudDtzb3BfZGV2ID0gcGFyKGRhdGEsICJodG1sLnBhcnNlciIpO21lbWJlcnMgPSBzb3BfZGV2LmZpbmQoImRpdiIsIGlkPSJvYmplY3RzX2NvbnRhaW5lciIpDQogICAgICAgICAgICAgICAgZm9yIGRldiBpbiBtZW1iZXJzLmZpbmRfYWxsKCJ0YWJsZSIpOg0KICAgICAgICAgICAgICAgICAgICB1c2VyXyA9IGRldlsiaWQiXS5yZXBsYWNlKCJtZW1iZXJfIiwgIiIpO25hbWFfID0gcmUuZmluZGFsbCgnPGltZyBhbHQ9IiguKiksIHByb2ZpbGUgcGljdHVyZSInLCBzdHIoZGV2KSlbMF0NCiAgICAgICAgICAgICAgICAgICAgdHJ5Ol9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsJ2ErJykud3JpdGUoc3RyKHVzZXJfKSsi4oCiIitzdHIobmFtYV8pKyJcbiIpLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICBwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgICAgICAgICBpZiAiU2VlIG1vcmUiIGluIHN0cihzb3BfZGV2KTp1cmwgPSBzb3BfZGV2LmZpbmQoImEiLCBzdHJpbmc9IlNlZSBtb3JlIilbImhyZWYiXTt1cmxfZ3J1cCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iK3VybDtzZWxmLmV4ZWNfZ3J1cF9zYXlhKCkNCiAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRlJPTSBNWSBHUk9VUCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpDQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0Vycm9yIERpIEJhZ2lhbiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgIGRlZiBtYW51YWwoc2VsZik6DQogICAgICAgIGlkPV9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBHUk9VUCBJRCA6ICIlKEgsUCxILEspKQ0KICAgICAgICBpZiBpZD09IiI6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHI9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKCJodHRwczovL20uZmFjZWJvb2suY29tL2dyb3Vwcy8iK2lkLGhlYWRlcnM9aGVhZGVyX2dydXAsY29va2llcz1zZWxmLmNvb2tpZXMpLnRleHQsImh0bWwucGFyc2VyIikNCiAgICAgICAgICAgIGlmICJubyBjb250ZW50IiBpbiByLmZpbmQoInRpdGxlIikudGV4dC5sb3dlcigpOmphbGFuKCclcyBbJXMhJXNdICVzUFJJVkFURSBHUk9VUCAvIFdST05HIElEJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBzZWxmLmxpc3RlZD17ImlkIjppZCwibmFtZSI6ci5maW5kKCJ0aXRsZSIpLnRleHR9O3NlbGYuZihpZCk7cHJpbnQoJyVzICclKE8pKTtwcmludCgiJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzIiUoSCxQLEgsSyxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3hkID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0R1bXAgSUQvVXNlcm5hbWU/IFtpL3VdIDogJyUoSCxQLEgsSykpO3ByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpDQogICAgICAgICAgICAgICAgaWYgeGQgaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgICAgIGVsaWYgeGQgaW4gWydpJywnSScsJzEnXToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF9pZCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitpZCk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0Vycm9yIERpIEJhZ2lhbiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgICAgIGVsaWYgeGQgaW4gWyd1JywnVScsJzInXToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF91c2VybmFtZSgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitpZCk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIERhcmkgJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcyclKE0sUCxNLE0sX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgICAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpICAgIA0KICAgIGRlZiBzZWFyY2goc2VsZik6DQogICAgICAgIHdoaXRlbGlzdD1bXTtxPV9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNOQU1FIDogJyUoSCxQLEgsSykpLmxvd2VyKCkNCiAgICAgICAgaWYgcT09Jyc6c2VsZi5zZWFyY2goKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgZm9yIGUsaSBpbiBlbnVtZXJhdGUoc2VsZi5nbGlzdCk6DQogICAgICAgICAgICAgICAgaWYgcSBpbiBpLmdldCgibmFtZSIpLmxvd2VyKCk6d2hpdGVsaXN0LmFwcGVuZChpKTtwcmludCgnJXMgWyVzJXMlc10gJXMlcyclKE8sUCxsZW4od2hpdGVsaXN0KSxPLFAsaS5nZXQoIm5hbWUiKS5yZXBsYWNlKHEsIiVzIiUocSkpKSkNCiAgICAgICAgICAgIGlmIGxlbih3aGl0ZWxpc3QpPT0wOmphbGFuKCclcyBbJXMhJXNdICVzUFJJVkFURSBHUk9VUCBPUiBXUk9ORyBJRCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsc2U6c2VsZi5jaG9pY2Uod2hpdGVsaXN0LHEpDQogICAgZGVmIGNob2ljZShzZWxmLCB3aGl0ZWxpc3QscSk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHNlbGYubGlzdGVkPXdoaXRlbGlzdFtpbnQoX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKSktaW50KDEpXTtzZWxmLmYocSk7cHJpbnQoJyVzICclKE8pKTtwcmludCgiJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzIiUoSCxQLEgsSyxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3hkID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0RVTVAvVVNFUk5BTUU/ICVzWyVzaSVzLyVzdSVzXSA6ICclKEgsUCxILEssWixNLFosSCxaKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSkNCiAgICAgICAgICAgIGlmIHhkIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsaWYgeGQgaW4gWydpJywnSScsJzEnXToNCiAgICAgICAgICAgICAgICB0cnk6c2VsZi5kdW1wX2lkKCJodHRwczovL20uZmFjZWJvb2suY29tL2dyb3Vwcy8iK3NlbGYubGlzdGVkLmdldCgiaWQiKSk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIERhcmkgJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRlJPTSAlcyIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpDQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFUlJPUiBJTiBTRUNUSU9OIDogJXMnJShNLFAsTSxQLF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpDQogICAgICAgICAgICBlbGlmIHhkIGluIFsndScsJ1UnLCcyJ106DQogICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF91c2VybmFtZSgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitzZWxmLmxpc3RlZC5nZXQoImlkIikpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIERhcmkgJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgZihzZWxmLGlkKToNCiAgICAgICAgc2VsZi5mbD0oaWQucmVwbGFjZSgnICcsJ18nKSsnLmpzb24nKQ0KICAgICAgICBpZiBzZWxmLmZsPT0nJzpzZWxmLmYoKQ0KICAgICAgICB0cnk6b3MucmVtb3ZlKHNlbGYuZmwpDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsInciKS5jbG9zZSgpDQogICAgZGVmIGR1bXBfdXNlcm5hbWUoc2VsZiwgdXJsKToNCiAgICAgICAgcj1iczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8odXJsLGNvb2tpZXM9c2VsZi5jb29raWVzLGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQsImh0bWwucGFyc2VyIik7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImgzIik6DQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgaWYgbGVuKGJzNC5yZS5maW5kYWxsKCJcLyIsaS5maW5kKCJhIixocmVmPVRydWUpLmdldCgiaHJlZiIpKSk9PTE6DQogICAgICAgICAgICAgICAgICAgIG9nZWg9aS5maW5kKCJhIixocmVmPVRydWUpDQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gb2dlaC5nZXQoImhyZWYiKToNCiAgICAgICAgICAgICAgICAgICAgICAgIGE9IiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLG9nZWguZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGEpPT0wOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGEgaW4gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsImErIikud3JpdGUoIiVz4oCiJXNcbiIlKGEsb2dlaC50ZXh0KSk7Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIGE9IiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLG9nZWguZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGEpPT0wOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGEgaW4gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsImErIikud3JpdGUoIiVz4oCiJXNcbiIlKGEsb2dlaC50ZXh0KSkNCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJhIixocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgIlNlZSBNb3JlIFBvc3RzIiBpbiBpLnRleHQ6DQogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF91c2VybmFtZSgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iK2kuZ2V0KCJocmVmIikpO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgnXHIlcyBbJXMhJXNdICVzUkVQRUFUJyUoTSxQLE0sTSkpO2NvbnRpbnVlDQogICAgZGVmIGR1bXBfaWQoc2VsZiwgdXJsKToNCiAgICAgICAgcj1iczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8odXJsLGNvb2tpZXM9c2VsZi5jb29raWVzLGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQsImh0bWwucGFyc2VyIik7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImgzIik6DQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgaWYgbGVuKGJzNC5yZS5maW5kYWxsKCJcLyIsaS5maW5kKCJhIixocmVmPVRydWUpLmdldCgiaHJlZiIpKSk9PTE6DQogICAgICAgICAgICAgICAgICAgIG9nZWg9aS5maW5kKCJhIixocmVmPVRydWUpDQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gb2dlaC5nZXQoImhyZWYiKToNCiAgICAgICAgICAgICAgICAgICAgICAgIGE9IiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLG9nZWguZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGEpPT0wOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGEgaW4gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsImErIikud3JpdGUoIiVz4oCiJXNcbiIlKGEsb2dlaC50ZXh0KSk7Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIGE9IiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLG9nZWguZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGEpPT0wOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGEgaW4gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsImErIikud3JpdGUoIiVz4oCiJXNcbiIlKF9nZXRfaWRfKGEpLG9nZWgudGV4dCkpDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIGkgaW4gci5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgTW9yZSBQb3N0cyIgaW4gaS50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfaWQoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIitpLmdldCgiaHJlZiIpKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJ1xyJXMgWyVzISVzXSAlc01lbmd1bGFuZ2knJShNLFAsTSxQKSk7Y29udGludWUNCg0KDQpkZWYgX2dldF9pZF8odXNlcm5hbWUpOg0KICAgIHVybCA9ICJodHRwczovL2xvb2t1cC1pZC5jb20vIyINCiAgICB3aXRoIF9yZXFfc2VzXyBhcyBkZXY6DQogICAgICAgIHBheWxvYWQgPSB7ImZidXJsIjogImh0dHBzOi8vbS5mYWNlYm9vay5jb20ve30iLmZvcm1hdCh1c2VybmFtZSksICJjaGVjayI6ICJMb29rdXAifQ0KICAgICAgICBpZiAiZmFjZWJvb2siIGluIHVzZXJuYW1lOnBheWxvYWQgPSB7ImZidXJsIjogdXNlcm5hbWUsICJjaGVjayI6ICJMb29rdXAifQ0KICAgICAgICBkYXRhX2RldiA9IGRldi5wb3N0KHVybCwgZGF0YT1wYXlsb2FkKS5jb250ZW50O3NvcF8gPSBwYXIoZGF0YV9kZXYsICJodG1sLnBhcnNlciIpO2lkXyA9IHNvcF8uZmluZCgic3BhbiIsIGlkPSJjb2RlIik7dXNlcl9nZXRfaWQgPSBpZF8udGV4dA0KICAgICAgICByZXR1cm4gdXNlcl9nZXRfaWQNCg0KDQpkZWYgZHVtcF9uYW1lKF9hemltdmF1Xyk6DQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBLUklTSE5BLEtBTkhBJyUoSCxQLEgsSykpO19fbmFtZV9fID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIE5BTUUgOiAnJShILFAsSCxLKSkuc3BsaXQoJywnKTtfZmlsZV8gPSAnZHVtcF9uYW1lLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBmb3IgX25hbWVfIGluIF9fbmFtZV9fOl91cmxfID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZWFyY2gvcGVvcGxlLz9xPSIrX25hbWVfO2NhcmlfbmFtYShfZmlsZV8sX2F6aW12YXVfLF91cmxfKQ0KICAgIF9idWthX2ZpbGVfID0gX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdyJykucmVhZCgpLnNwbGl0bGluZXMoKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzIiUoSCxQLEgsSyxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQpkZWYgY2FyaV9uYW1hKF9maWxlXyxfY29va2llc18sX3VybF8pOg0KICAgIF9hemltdmF1X2RhcHVudGFfKF9maWxlXywiYSsiKTtfcmVxX3Nlc19kZXZfID0gYnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKF91cmxfLCBjb29raWVzPV9jb29raWVzXyxoZWFkZXJzPWhlYWRlcl9uYW1hKS50ZXh0LCJodG1sLnBhcnNlciIpDQogICAgZm9yIF9hemltdmF1X2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgcHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBpZiAiPGltZyBhbHQ9IiBpbiBzdHIoX2F6aW12YXVfZGV2Xyk6DQogICAgICAgICAgICBpZiAiaG9tZS5waHAiIGluIHN0cihfYXppbXZhdV9kZXZfWyJocmVmIl0pOmNvbnRpbnVlDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIF9zdHJfZGV2XyA9IHN0cihfYXppbXZhdV9kZXZfWyJocmVmIl0pDQogICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfc3RyX2Rldl86DQogICAgICAgICAgICAgICAgICAgIF9uYW1lXyA9IF9hemltdmF1X2Rldl8uZmluZCgiaW1nIikuZ2V0KCJhbHQiKS5yZXBsYWNlKCIsIHByb2ZpbGUgcGljdHVyZSIsIiIpO19maW5kXyA9IGJzNC5yZS5maW5kYWxsKCIvcHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9zdHJfZGV2XykNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuIChfZmluZF8pICE9MDoNCiAgICAgICAgICAgICAgICAgICAgICAgIF91c2VyXyA9ICIiLmpvaW4oX2ZpbmRfKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX3VzZXJfIGluIF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfdXNlcl8sX25hbWVfKSkNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBfZmluZF8gPSBiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9zdHJfZGV2Xyk7X25hbWVfID0gX2F6aW12YXVfZGV2Xy5maW5kKCJpbWciKS5nZXQoImFsdCIpLnJlcGxhY2UoIiwgcHJvZmlsZSBwaWN0dXJlIiwiIikNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKF9maW5kXykgIT0wOg0KICAgICAgICAgICAgICAgICAgICAgICAgX3VzZXJfPSIiLmpvaW4oX2ZpbmRfKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX3VzZXJfIGluIF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfdXNlcl8sX25hbWVfKSkNCiAgICAgICAgaWYgIlNlZSBNb3JlIFJlc3VsdHMiIGluIF9hemltdmF1X2Rldl8udGV4dDpjYXJpX25hbWEoX2ZpbGVfLF9jb29raWVzXyxfYXppbXZhdV9kZXZfWyJocmVmIl0pDQoNCg0KY2xhc3MgZHVtcF9wZXNhbjoNCiAgICBkZWYgX19pbml0X18oc2VsZixfY29va2llc18sX25hbWFfLF9pZF8pOg0KICAgICAgICBzZWxmLmNvb2tpZXMgPSBfY29va2llc187c2VsZi5pZCA9IF9pZF87c2VsZi5maWxlcyA9IChfbmFtYV8rJy5qc29uJykucmVwbGFjZSgiICIsIl8iKTtfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZpbGVzLCJ3IikuY2xvc2UoKTtzZWxmLmR1bXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbWVzc2FnZXMiKQ0KICAgIGRlZiBkdW1wKHNlbGYsdXJsKToNCiAgICAgICAgX3JlcV9zZXNfZGV2XyA9IGJzNC5CZWF1dGlmdWxTb3VwKF9yZXFfZ2V0Xyh1cmwsaGVhZGVycz1oZWFkZXJfbmFtYSxjb29raWVzPXNlbGYuY29va2llcykudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBmb3IgX2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICIvbWVzc2FnZXMvcmVhZCIgaW4gX2Rldl8uZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgX3NvdXBfID0gYnM0LnJlLmZpbmRhbGwoImNpZFwuY1wuKC4qPyklM0EoLio/KSYiLF9kZXZfLmdldCgiaHJlZiIpKQ0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgZm9yIF91c2VyXyBpbiBsaXN0KF9zb3VwXy5wb3AoKSk6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfdXNlcl8gaW4gc2VsZi5pZDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAiRmFjZWJvb2sgdXNlciIgaW4gX2Rldl8udGV4dC5sb3dlcigpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcywiYSsiKS53cml0ZSgiJXPigKIlc1xuIiUoX3VzZXJfLF9kZXZfLnRleHQpKTtwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOmNvbnRpbnVlDQogICAgICAgICAgICBpZiAiU2VlIE9sZGVyIE1lc3NhZ2VzIiBpbiBfZGV2Xy50ZXh0OnNlbGYuZHVtcCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iK19kZXZfLmdldCgiaHJlZiIpKQ0KICAgICAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmlsZXMsJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMiJShILFAsSCxLLHN0cihsZW4oX2J1a2FfZmlsZV8pKSkpDQogICAgICAgIHJldHVybiBjcmFjayhzZWxmLmZpbGVzKQ0KDQoNCg0KZGVmIGZpbGUoKToNCgl0cnk6DQoJCXByaW50KCIiKQ0KCQl4YyA9IGlucHV0KCclcyBbJXPigKIlc10gJXNGSUxFIDogJXMnJShILFAsSCxLLEgpKQ0KCQlpZCA9IG9wZW4oeGMpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCgkJcHJpbnQoJyVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyclKEgsUCxILE8sSCxsZW4oaWQpKSkNCgkJcmV0dXJuIGNyYWNrKHhjKQ0KCWV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoNCgkJcHJpbnQoIiVzIFslcyElc10gJXNGSUxFIE5PVCBFWElTVElORyIlKE0sUCxNLE0pKQ0KCQlmaWxlKCkNCgkJDQoNCmRlZiBkdW1wX2VtYWlsKCk6DQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBrcmlzaG5ha2FuaGEgIiUoSCxQLEgsSykpO19xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIlKEgsUCxILEspKS5sb3dlcigpDQogICAgaWYgbGVuKF9xdWVyeV8pIDwgMzpqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzZ21haWwuY29tIiUoSCxQLEgsSyxIKSk7X2RvbWFpbl8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRE9NQUlOIDogIiUoSCxQLEgsSykpLmxvd2VyKCkNCiAgICBpZiAnQCcgaW4gX2RvbWFpbl86X2RvbWFpbl8gPSBfZG9tYWluXy5zcGxpdCgnQCcpWzFdDQogICAgX2xpbWl0X2F3YWxfID0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBTVEFSSU5HIE5VTUJFUiA6ICIlKEgsUCxILEspKSk7X2xpbWl0X2FraGlyXz0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBFTkRJTkcgTlVNQkVSIDogIiUoSCxQLEgsSykpKTtfZmlsZV8gPSAoX3F1ZXJ5XysiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2VtYWlsKF9xdWVyeV8sX2RvbWFpbl8sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKQ0KZGVmIGV4ZWNfZW1haWwoX19xdWVyeV9fLF9kb21haW5fLF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfLF9maWxlXyk6DQogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfMl8gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsXzNfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXysxDQogICAgaWYgJyAnIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy0nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbHNlOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5IDoNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzFfO2VtYWlsID0gKCclcyVzQCVzJyUoX3F1ZXJ5XzFfLHN0cihfaGl0dW5nX2VtYWlsXzFfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlc0AlcyclKF9xdWVyeV8yXyxzdHIoX2hpdHVuZ19lbWFpbF8yXyksX2RvbWFpbl8pKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfM187ZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfM18sc3RyKF9oaXR1bmdfZW1haWxfM18pLF9kb21haW5fKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBpZiAnLicgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCcuJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCdfJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCctJywnICcpDQogICAgICAgICAgICAgICAgZWxzZTpfcXVlcnlfID0gX19xdWVyeV9fLnJlcGxhY2UoJyAnLCcnKTtuYW1hID0gX19xdWVyeV9fDQogICAgICAgICAgICAgICAgZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfLHN0cihfaGl0dW5nX2VtYWlsX2Z1bGxfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfZnVsbF8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgZXhjZXB0Og0KICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc1RIRVJFIElTIEFOIEVSUk9SJyUoTSxQLE0sTSkpDQogICAgICAgIHRpbWUuc2xlZXAoMikNCiAgICAgICAgbWVudSgpDQogICAgX2J1a2FfZmlsZV8gPSBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIGR1bXBfdXNlcm5hbWUoKToNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzS1JJU0hOQSBLQU5IQSIlKEgsUCxILEssSCkpO19xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIlKEgsUCxILEspKS5sb3dlcigpDQogICAgaWYgbGVuKF9xdWVyeV8pIDwgMzpqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnJShNLFAsTSxNKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBfbGltaXRfYXdhbF8gPSBpbnQoX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFNUQVJUSU5HIE5VTUJFUiAoRVg6IDEpIDogIiUoSCxQLEgsUCkpKTtfbGltaXRfYWtoaXJfPSBpbnQoX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIEVORElORyBOVU1CRVIgKEVYOiAxMDAwKTogIiUoSCxQLEgsUCkpKTtfZmlsZV8gPSAoX3F1ZXJ5XysiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX3VzZXJuYW1lKF9xdWVyeV8sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKQ0KZGVmIGV4ZWNfdXNlcm5hbWUoX19xdWVyeV9fLF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfLF9maWxlXyk6DQogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfMl8gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsXzNfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXysxDQogICAgaWYgJyAnIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy0nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbHNlOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5IDoNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzFfO2VtYWlsID0gKCclcyVzJyUoX3F1ZXJ5XzFfLHN0cihfaGl0dW5nX2VtYWlsXzFfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlcyclKF9xdWVyeV8yXyxzdHIoX2hpdHVuZ19lbWFpbF8yXykpKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfM187ZW1haWwgPSAoJyVzJXMnJShfcXVlcnlfM18sc3RyKF9oaXR1bmdfZW1haWxfM18pKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBpZiAnLicgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCcuJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCdfJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCctJywnICcpDQogICAgICAgICAgICAgICAgZWxzZTpfcXVlcnlfID0gX19xdWVyeV9fLnJlcGxhY2UoJyAnLCcnKTtuYW1hID0gX19xdWVyeV9fDQogICAgICAgICAgICAgICAgZW1haWwgPSAoJyVzJXMnJShfcXVlcnlfLHN0cihfaGl0dW5nX2VtYWlsX2Z1bGxfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfZnVsbF8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgZXhjZXB0OmphbGFuKCclcyBbJXMhJXNdICVzVEhFUkUgSVMgQU4gRVJST1InJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKF9maWxlXywncicpLnJlYWQoKS5zcGxpdGxpbmVzKCk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCiMjIyBEdW1wIElEIEZyb20gSGFzaHRhZw0KZGVmIGhhc2h0YWcoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBIQVNIVEFHIDogJyUoSCxQLEgsQikpO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vaGFzaHRhZy8nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX2hhc2h0YWcoX3VybF9kZXZfLGNvb2tpZXMsX2ZpbGVfKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBleGVjX2hhc2h0YWcodXJsLGNvb2tpZXMsX2ZpbGVfKToNCiAgICBvcGVuKF9maWxlXywnYScpO19yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTtfcmVxX2dldF8gPSBfcmVxX3Nlc18uZ2V0KHVybCxjb29raWVzPWNvb2tpZXMsaGVhZGVycz1oZWFkZXJfaGFzaHRhZyk7X3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCdodG1sLnBhcnNlcicpO19idWthX2ZpbGVfID0gb3BlbihfZmlsZV8pLnJlYWQoKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX2NpY2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2F6aW12YXVfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnLycgaW4gX2lkX2Rldl86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBSZXN1bHRzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfaGFzaHRhZyh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpkZWYgYmVyYW5kYShjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hvbWUucGhwJztfZmlsZV8gPSAnYmVyYW5kYS5qc29uJw0KICAgIHRyeTpvcy5yZW1vdmUoX2ZpbGVfKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7ZXhlY19iZXJhbmRhKF91cmxfZGV2Xyxjb29raWVzLF9maWxlXyk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQpkZWYgZXhlY19iZXJhbmRhKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtfYnVrYV9maWxlXyA9IG9wZW4oX2ZpbGVfKS5yZWFkKCk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9jaWNpXy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfbmFtZV9kZXZfIGluIF9idWthX2ZpbGVfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBTdG9yaWVzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfYmVyYW5kYSh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2ZyaWVuZHMvY2VudGVyL3JlcXVlc3RzJztfZmlsZV8gPSAnZnJpZW5kX2xvZ2luLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICcvZnJpZW5kcy9ob3ZlcmNhcmQnIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICB0cnk6X25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgndWlkPSguKj8pJicsX2F6aW12YXVfLmdldCgnaHJlZicpKSk7b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIE1vcmUnIGluIF9hemltdmF1Xy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfYXppbXZhdV8uZ2V0KCdocmVmJyk7ZXhlY19wZXJtaW50YWFuX3BlcnRlbWFuYW5fbWFzdWsodXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9rZWx1YXIoY29va2llcyk6DQogICAgX3VybF9kZXZfID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9mcmllbmRzL2NlbnRlci9yZXF1ZXN0cy9vdXRnb2luZyc7X2ZpbGVfID0gJ2ZyaWVuZF9vdXQuanNvbicNCiAgICB0cnk6b3MucmVtb3ZlKF9maWxlXykNCiAgICBleGNlcHQ6cGFzcw0KICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcihfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmwsY29va2llcyxfZmlsZV8pOg0KICAgIG9wZW4oX2ZpbGVfLCdhJyk7X3JlcV9zZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpO19yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLGNvb2tpZXM9Y29va2llcyxoZWFkZXJzPWhlYWRlcl9uYW1hKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnL2ZyaWVuZHMvaG92ZXJjYXJkJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6DQogICAgICAgICAgICAgICAgdHJ5Ol9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ3VpZD0oLio/KSYnLF9hemltdmF1Xy5nZXQoJ2hyZWYnKSkpO29wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgZWxzZTpwYXNzDQogICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgJ1NlZSBNb3JlJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KIyMjIENoZWNrIFRhcmdldCBDcmFjaw0KZGVmIGNla190YXJnZXRfY3JhY2tfKF9pZF8pOg0KICAgIG9wZW4oJ2xpc3RfaWQudHh0JywnYSsnKQ0KICAgIHRyeToNCiAgICAgICAgX2Nla18gPSBvcGVuKCdsaXN0X2lkLnR4dCcsJ3InKS5yZWFkKCkNCiAgICAgICAgaWYgX2lkXyBpbiBfY2VrXzoNCiAgICAgICAgICAgIGlmIF9pZF8gPT0gJ21lJzpwYXNzDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIF9jb2t6el8gPSBfY2ljaV9hemltdmF1XygnJXMgWyVzISVzXSAlc0lEIEhBUyBCRUVOIENSQUNLRUQsIENPTlRJTlVFPyBbWS9uXSA6ICclKE0sUCxNLFApKQ0KICAgICAgICAgICAgICAgIGlmIF9jb2t6el8gaW4gWycnLCcgJ106cGFzcw0KICAgICAgICAgICAgICAgIGVsaWYgX2Nva3p6XyBpbiBbJzEnLCcwMScsJ3knXTpwYXNzDQogICAgICAgICAgICAgICAgZWxpZiBfY29renpfIGluIFsnMicsJzAnLCduJ106bWVudSgpDQogICAgICAgICAgICAgICAgZWxzZTpwYXNzDQogICAgICAgIGVsc2U6X2F6aW12YXVfZGFwdW50YV8oJ2xpc3RfaWQudHh0JywiYSsiKS53cml0ZSgiJXNcbiIlKF9pZF8pKQ0KICAgIGV4Y2VwdDpwYXNzDQoNCiMjIyBHZW5lcmF0ZSBQYXNzd29yZA0KZGVmIGdlbmVyYXRlMShfY2ljaV8pOg0KICAgIF9hemltdmF1Xz1bXQ0KICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOg0KICAgICAgICBpZiBsZW4oaSk8Mzpjb250aW51ZSANCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGk9aS5sb3dlcigpDQogICAgICAgICAgICBpZiBsZW4oaSk9PTMgb3IgbGVuKGkpPT00IG9yIGxlbihpKT09NTpfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKQ0KICAgICAgICAgICAgZWxpZiBsZW4oaSk+PTY6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKQ0KICAgICAgICAgICAgZWxzZTpjb250aW51ZQ0KICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkpDQogICAgcmV0dXJuIF9hemltdmF1Xw0KDQpkZWYgZ2VuZXJhdGUyKF9jaWNpXyk6DQogICAgX2F6aW12YXVfPVtdDQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6DQogICAgICAgIGlmIGxlbihpKTwzOmNvbnRpbnVlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKTtfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0rX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVsxXSkNCiAgICByZXR1cm4gX2F6aW12YXVfDQoNCmRlZiBnZW5lcmF0ZTMoX2NpY2lfKToNCiAgICBfYXppbXZhdV89W10NCiAgICBmb3IgaSBpbiBfY2ljaV8uc3BsaXQoIiAiKToNCiAgICAgICAgaWYgbGVuKGkpPDM6Y29udGludWUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGk9aS5sb3dlcigpDQogICAgICAgICAgICBpZiBsZW4oaSk9PTMgb3IgbGVuKGkpPT00IG9yIGxlbihpKT09NTpfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNCIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKTtfYXppbXZhdV8uYXBwZW5kKGkrIkAxMjMiKQ0KICAgICAgICAgICAgZWxzZTpfYXppbXZhdV8uYXBwZW5kKGkpO19hemltdmF1Xy5hcHBlbmQoaSsiMSIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNCIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKTtfYXppbXZhdV8uYXBwZW5kKGkudXBwZXIoKSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyJAIyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzQCMiKQ0KICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkpO19hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVswXStfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzFdKTtfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0rX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVsxXSsiMTIiKTtfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0rX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVsxXSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZCgiaWxvdmV5b3UiKQ0KICAgIHJldHVybiBfYXppbXZhdV8NCg0KDQpkZWYgZ2VuZXJhdGU0KF9jaWNpXyk6DQogICAgX2F6aW12YXVfPVtdDQogICAgcHMgPSBfYXppbXZhdV9kYXB1bnRhXygncGFzcy50eHQnLCdyJykucmVhZCgpDQogICAgcHAgPSBfYXppbXZhdV9kYXB1bnRhXygnZGlnaXRwYXNzLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBmb3IgaSBpbiBfY2ljaV8uc3BsaXQoIiAiKTogIA0KICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICBpZiBsZW4oaSk8Mzpjb250aW51ZQ0KICAgICAgICBlbGlmIGxlbihpKT09MyBvciBsZW4oaSk9PTQgb3IgbGVuKGkpPT01Ol9hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpDQogICAgICAgIGVsc2U6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKQ0KICAgIGlmIHBwIGluIFsnJywnICcsJyAgJ106cGFzcw0KICAgIGVsc2U6DQogICAgICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOiAgDQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgZm9yIHggaW4gcHAuc3BsaXQoJywnKTpfYXppbXZhdV8uYXBwZW5kKGkreCkNCiAgICBpZiBwcyBpbiBbJycsJyAnLCcgICddOnBhc3MNCiAgICBlbHNlOg0KICAgICAgICBmb3IgeiBpbiBwcy5zcGxpdCgnLCcpOl9hemltdmF1Xy5hcHBlbmQoeikNCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKQ0KICAgIHJldHVybiBfYXppbXZhdV8NCmRlZiB0YW1iYWhfcGFzcygpOg0KICAgIHByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiAlc0FtZXJpY2EsMTIzNDU2LDEwMjAzMCw3ODY3ODYnJShILFAsSCxLLEgpKTtjdXkgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgTUFOVUFMIFNVUFBMRU1FTlRBTCBQQVNTIFsxIFdPUkRdIDogJyUoSCxQLEgsSykpO2doID0gX2F6aW12YXVfZGFwdW50YV8oJ3Bhc3MudHh0JywndycpO2doLndyaXRlKGN1eSk7Z2guY2xvc2UNCmRlZiB0YW1iYWhfcGFzc19hbmdrYSgpOg0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogJXMxNDMsNzg2LGdhbWluZyclKEgsUCxILEssSCkpO2NveSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBBRERJVElPTkFMIFBBU1MgQkVISU5EIE5BTUUgOiAnJShILFAsSCxLKSk7eHkgPSBfYXppbXZhdV9kYXB1bnRhXygnZGlnaXRwYXNzLnR4dCcsJ3cnKTt4eS53cml0ZShjb3kpO3h5LmNsb3NlDQogICAgDQojIyMgTG9nZ2VyIENyYWNrDQpkZWYgbG9nX2FwaV8xKGVtLHBhcyk6DQogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywncicpLnJlYWQoKQ0KICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICBoZWFkZXIgPSB7IngtZmItY29ubmVjdGlvbi1iYW5kd2lkdGgiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAwMDAuMCwgMzAwMDAwMDAuMCkpLCJ4LWZiLXNpbS1obmkiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAsIDQwMDAwKSksIngtZmItbmV0LWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwieC1mYi1jb25uZWN0aW9uLXF1YWxpdHkiOiAiRVhDRUxMRU5UIiwieC1mYi1jb25uZWN0aW9uLXR5cGUiOiAiY2VsbC5DVFJhZGlvQWNjZXNzVGVjaG5vbG9neUhTRFBBIiwidXNlci1hZ2VudCI6IHVhLCJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwieC1mYi1odHRwLWVuZ2luZSI6ICJMaWdlciJ9DQogICAgcmVzcG9uc2UgPSByLmdldCgnaHR0cHM6Ly9iLWFwaS5mYWNlYm9vay5jb20vbWV0aG9kL2F1dGgubG9naW4/Zm9ybWF0PWpzb24mZW1haWw9JyArIGVtICsgJyZwYXNzd29yZD0nICsgcGFzICsgJyZjcmVkZW50aWFsc190eXBlPWRldmljZV9iYXNlZF9sb2dpbl9wYXNzd29yZCZnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXM9MSZlcnJvcl9kZXRhaWxfdHlwZT1idXR0b25fd2l0aF9kaXNhYmxlZCZzb3VyY2U9ZGV2aWNlX2Jhc2VkX2xvZ2luJm1ldGFfaW5mX2ZibWV0YT0lMjAmY3VycmVudGx5X2xvZ2dlZF9pbl91c2VyaWQ9MCZtZXRob2Q9R0VUJmxvY2FsZT1lbl9VUyZjbGllbnRfY291bnRyeV9jb2RlPVVTJmZiX2FwaV9jYWxsZXJfY2xhc3M9Y29tLmZhY2Vib29rLmZvcy5oZWFkZXJzdjIuZmI0YW9yY2EuSGVhZGVyc1YyQ29uZmlnRmV0Y2hSZXF1ZXN0SGFuZGxlciZhY2Nlc3NfdG9rZW49MzUwNjg1NTMxNzI4fDYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJmZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZT1hdXRoZW50aWNhdGUmY3BsPXRydWUnLCBoZWFkZXJzPWhlYWRlcikNCiAgICBpZiAnc2Vzc2lvbl9rZXknIGluIHJlc3BvbnNlLnRleHQgYW5kICdFQUFBJyBpbiByZXNwb25zZS50ZXh0OnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfYXBpXzIoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIGhlYWRlciA9IHsieC1mYi1jb25uZWN0aW9uLWJhbmR3aWR0aCI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMDAwMC4wLCAzMDAwMDAwMC4wKSksIngtZmItc2ltLWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCJ4LWZiLWNvbm5lY3Rpb24tcXVhbGl0eSI6ICJFWENFTExFTlQiLCJ4LWZiLWNvbm5lY3Rpb24tdHlwZSI6ICJjZWxsLkNUUmFkaW9BY2Nlc3NUZWNobm9sb2d5SFNEUEEiLCJ1c2VyLWFnZW50IjogdWEsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCJ4LWZiLWh0dHAtZW5naW5lIjogIkxpZ2VyIn0NCiAgICBwYXJhbSA9IHsnYWNjZXNzX3Rva2VuJzogJzM1MDY4NTUzMTcyOCU3QzYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJywgJ2Zvcm1hdCc6ICdqc29uJywgJ3Nka192ZXJzaW9uJzogJzInLCAnZW1haWwnOiBlbSwgJ2xvY2FsZSc6ICdlbl9VUycsICdwYXNzd29yZCc6IHBhcywgJ3Nkayc6ICdpb3MnLCAnZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzJzogJzEnLCAnc2lnJzonM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYnfQ0KICAgIGFwaSA9ICdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbicNCiAgICByZXNwb25zZSA9IHIuZ2V0KGFwaSwgcGFyYW1zPXBhcmFtLCBoZWFkZXJzPWhlYWRlcikNCiAgICBpZiAnc2Vzc2lvbl9rZXknIGluIHJlc3BvbnNlLnRleHQgYW5kICdFQUFBJyBpbiByZXNwb25zZS50ZXh0OnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfbWJhc2ljXzEoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIikNCiAgICBiID0gci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4ucGhwIiwgZGF0YT17ImVtYWlsIjogZW0sICJwYXNzIjogcGFzLCAibG9naW4iOiAic3VibWl0In0pDQogICAgX3Jhd19jb29raWVzXyA9ICgiOyIpLmpvaW4oWyAiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIHIuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkNCiAgICBpZiAiY191c2VyIiBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbGlmICJjaGVja3BvaW50IiBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6cmV0dXJuIHsic3RhdHVzIjoiY3AiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQpkZWYgbG9nX21iYXNpY18yKGVtLHBhcyk6DQogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywncicpLnJlYWQoKQ0KICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICByLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6Im1iYXNpYy5mYWNlYm9vay5jb20iLCJjYWNoZS1jb250cm9sIjoibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6IjEiLCJ1c2VyLWFnZW50Ijp1YSwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyJ9KQ0KICAgIHAgPSByLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIpDQogICAgYiA9IGJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgIG1ldGE9IiIuam9pbihiczQucmUuZmluZGFsbCgnZHRzZyI6XHsidG9rZW4iOiIoLio/KSInLHAudGV4dCkpDQogICAgZGF0YT17fQ0KICAgIGZvciBpIGluIGIoImlucHV0Iik6DQogICAgICAgIGlmIGkuZ2V0KCJ2YWx1ZSIpIGlzIE5vbmU6DQogICAgICAgICAgICBpZiBpLmdldCgibmFtZSIpPT0iZW1haWwiOmRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkNCiAgICAgICAgICAgIGVsaWYgaS5nZXQoIm5hbWUiKT09InBhc3MiOmRhdGEudXBkYXRlKHsicGFzcyI6cGFzfSkNCiAgICAgICAgICAgIGVsc2U6ZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6IiJ9KQ0KICAgICAgICBlbHNlOmRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkNCiAgICBkYXRhLnVwZGF0ZSh7ImZiX2R0c2ciOm1ldGEsIm1fc2VzcyI6IiIsIl9fdXNlciI6IjAiLCJfX3JlcSI6ImQiLCJfX2NzciI6IiIsIl9fYSI6IiIsIl9fZHluIjoiIiwiZW5jcGFzcyI6IiJ9KQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJyZWZlcmVyIjoiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCJ9KQ0KICAgIHBvID0gci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dA0KICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pDQogICAgaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KZGVmIGxvZ19tb2JpbGVfMShlbSxwYXMpOg0KICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3InKS5yZWFkKCkNCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgci5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiJtLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tLyIpDQogICAgYiA9IHIucG9zdCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi5waHAiLCBkYXRhPXsiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJsb2dpbiI6ICJzdWJtaXQifSkNCiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbICIlcz0lcyIgJSAoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gci5jb29raWVzLmdldF9kaWN0KCkuaXRlbXMoKSBdKQ0KICAgIGlmICJjX3VzZXIiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJvayIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfbW9iaWxlXzIoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibS5mYWNlYm9vay5jb20iLCJjYWNoZS1jb250cm9sIjoibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6IjEiLCJ1c2VyLWFnZW50Ijp1YSwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyJ9KQ0KICAgIHAgPSByLmdldCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iKQ0KICAgIGIgPSBiczQuQmVhdXRpZnVsU291cChwLnRleHQsImh0bWwucGFyc2VyIikNCiAgICBtZXRhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ2R0c2ciOlx7InRva2VuIjoiKC4qPykiJyxwLnRleHQpKQ0KICAgIGRhdGE9e30NCiAgICBmb3IgaSBpbiBiKCJpbnB1dCIpOg0KICAgICAgICBpZiBpLmdldCgidmFsdWUiKSBpcyBOb25lOg0KICAgICAgICAgICAgaWYgaS5nZXQoIm5hbWUiKT09ImVtYWlsIjpkYXRhLnVwZGF0ZSh7ImVtYWlsIjplbX0pDQogICAgICAgICAgICBlbGlmIGkuZ2V0KCJuYW1lIik9PSJwYXNzIjpkYXRhLnVwZGF0ZSh7InBhc3MiOnBhc30pDQogICAgICAgICAgICBlbHNlOmRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOiIifSkNCiAgICAgICAgZWxzZTpkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTppLmdldCgidmFsdWUiKX0pDQogICAgZGF0YS51cGRhdGUoeyJmYl9kdHNnIjptZXRhLCJtX3Nlc3MiOiIiLCJfX3VzZXIiOiIwIiwiX19yZXEiOiJkIiwiX19jc3IiOiIiLCJfX2EiOiIiLCJfX2R5biI6IiIsImVuY3Bhc3MiOiIifSkNCiAgICByLmhlYWRlcnMudXBkYXRlKHsicmVmZXJlciI6Imh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pDQogICAgcG8gPSByLnBvc3QoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dA0KICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pDQogICAgaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KDQojIyMgQ2hlY2sgT3B0aW9ucw0KZGVmIGNla19vcHNpKHVzZXIscHcsZm9ybWF0KToNCiAgICBfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICB0cnk6Y2VrX2Rldl9vcHNpICAgICAgICAgID0gb3Blbignb3B0aW9uXy50eHQnLCdyJykucmVhZCgpDQogICAgZXhjZXB0OmNla19kZXZfb3BzaSAgICAgICA9ICdudWxsJw0KICAgIHRyeTpfYXV0b19jaGFuZ2VfcGFzc18gICAgPSBvcGVuKCdhdXRvX2dhbnRpLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBleGNlcHQ6X2F1dG9fY2hhbmdlX3Bhc3NfID0gJ1llcycNCiAgICB0cnk6Y2VrX3BpbGloX29wc2kgICAgICAgID0gb3BlbignbXVuY3VsX29wc2kudHh0JywncicpLnJlYWQoKQ0KICAgIGV4Y2VwdDpjZWtfcGlsaWhfb3BzaSAgICAgPSAnTm8nDQogICAgX3JlcV9zZXNfLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6Im1iYXNpYy5mYWNlYm9vay5jb20iLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLCJhY2NlcHQtZW5jb2RpbmciOiJnemlwLCBkZWZsYXRlIiwiYWNjZXB0LWxhbmd1YWdlIjoiZW4tR0IsZW4tVVM7cT0wLjkiLCJyZWZlcmVyIjoiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIsInVzZXItYWdlbnQiOnVhX2JsYWNrYmVycnl9KTtfc29wX2Rldl8gPSBwYXIoX3JlcV9zZXNfLmdldChob3N0KyIvbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04IikudGV4dCwiaHRtbC5wYXJzZXIiKTtfbGlua3VybF8gPSBfc29wX2Rldl8uZmluZCgiZm9ybSIseyJtZXRob2QiOiJwb3N0In0pDQogICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8oImlucHV0Iik6ZGF0YV8xLnVwZGF0ZSh7X2NpY2lfLmdldCgibmFtZSIpOl9jaWNpXy5nZXQoInZhbHVlIil9KQ0KICAgIGRhdGFfMS51cGRhdGUoeyJlbWFpbCI6dXNlciwicGFzcyI6cHd9KTtfdXJsX3Bvc3RfID0gX3JlcV9zZXNfLnBvc3QoaG9zdCtfbGlua3VybF8uZ2V0KCJhY3Rpb24iKSxkYXRhPWRhdGFfMSk7X3Jlc3BvbnNlXyA9IHBhcihfdXJsX3Bvc3RfLnRleHQsICJodG1sLnBhcnNlciIpDQogICAgaWYgImNfdXNlciIgaW4gX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKToNCiAgICAgICAgaWYgInlvdXIgYWNjb3VudCBoYXMgYmVlbiBsb2NrZWQiIGluIF91cmxfcG9zdF8udGV4dDpwYXNzDQogICAgICAgIGVsc2U6X2Nvb2tpZXNfID0gJycuam9pbihfcmVxX3Nlc18uY29va2llcy5nZXRfZGljdCgpKTtfcmVzdWx0X29rXyA9ICJcciAlc1slc0thY2hpLU9LJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSCxQLEgsdXNlcixwdyx0YWh1bih1c2VyKSxQKTtjZWtfYXBrKF9yZXN1bHRfb2tfLGN2dF9jb29raWVzKF9jb29raWVzXykpDQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKToNCiAgICAgICAgX3JhdHlhXyA9IDA7anVtbGFoX29wc2kgID0gW107X3RpdGxlX2Rldl8gPSByZS5maW5kYWxsKCJcPHRpdGxlPiguKj8pPFwvdGl0bGU+IixzdHIoX3Jlc3BvbnNlXykpO2xpbmtfMiA9IF9yZXNwb25zZV8uZmluZCgiZm9ybSIseyJtZXRob2QiOiJwb3N0In0pO2xpc3RfaW5wdXQgPSBbJ2ZiX2R0c2cnLCdqYXpvZXN0JywnY2hlY2twb2ludF9kYXRhJywnc3VibWl0W0NvbnRpbnVlXScsJ25oJ10NCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfcmVzcG9uc2VfKCJpbnB1dCIpOg0KICAgICAgICAgICAgaWYgX2F6aW12YXVfLmdldCgibmFtZSIpIGluIGxpc3RfaW5wdXQ6ZGF0YV8yLnVwZGF0ZSh7X2F6aW12YXVfLmdldCgibmFtZSIpOl9hemltdmF1Xy5nZXQoInZhbHVlIil9KQ0KICAgICAgICBfcmVxX2FjdF8gPSBfcmVxX3Nlc18ucG9zdChob3N0K2xpbmtfMi5nZXQoImFjdGlvbiIpLGRhdGE9ZGF0YV8yKTtfcmVzcG9uc2UyXyA9IHBhcihfcmVxX2FjdF8udGV4dCwiaHRtbC5wYXJzZXIiKTtfY2hlY2tfb3BzaV8gID0gW19zYWxzYWJpbGFfLnRleHQgZm9yIF9zYWxzYWJpbGFfIGluIF9yZXNwb25zZTJfLmZpbmRfYWxsKCJvcHRpb24iKV0NCiAgICAgICAgaWYgbGVuKF9jaGVja19vcHNpXyk9PTA6DQogICAgICAgICAgICBpZiAiQ2hlY2sgdGhlIGxvZ2luIGRldGFpbHMgc2hvd24uIFdhcyBpdCB5b3U/IiBpbiBfdGl0bGVfZGV2XzoNCiAgICAgICAgICAgICAgICBpZiBfYXV0b19jaGFuZ2VfcGFzc18gPT0gJ1llcyc6Y2hhbmdlX3Bhc3ModXNlcixfcmVxX3Nlc18sX3Jlc3BvbnNlXyxsaW5rXzIpDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgaWYgY2VrX3BpbGloX29wc2kgPT0gJ1llcyc6cHJpbnQoZm9ybWF0KTtwcmludCgnICAgJXPigKIgJXNPTkUgVEFQIEFDQ09VTlQnJShILFApKTtwcmludCgiIikNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpwcmludChmb3JtYXQpO3ByaW50KCcgICAlc+KAoiAlc09ORSBUQVAgQUNDT1VOVCclKEgsUCkpDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZWxpZiBsZW4oX2NoZWNrX29wc2lfKSE9MDoNCiAgICAgICAgICAgIGlmIGNla19waWxpaF9vcHNpID09ICdZZXMnOg0KICAgICAgICAgICAgICAgIGZvciBfYXN1XyBpbiByYW5nZShsZW4oX2NoZWNrX29wc2lfKSk6X3JhdHlhXyArPSAxO2p1bWxhaF9vcHNpLmFwcGVuZCgiXG4gICAgICIrUCtzdHIoX2FzdV8rMSkrIi4gIitfY2hlY2tfb3BzaV9bX2FzdV9dKyIgIikNCiAgICAgICAgICAgICAgICBqdW1vcCA9ICgnJXMgICBIRVJFIEFSRSAlcyBPUFRJT05TIDogJyUoUCxzdHIobGVuKGp1bWxhaF9vcHNpKSkpKTtwcmludChmb3JtYXQpO3ByaW50KGp1bW9wKyIiLmpvaW4oanVtbGFoX29wc2kpKTtwcmludCgiIikNCiAgICAgICAgICAgIGVsc2U6cHJpbnQoZm9ybWF0KQ0KICAgIGVsc2U6DQogICAgICAgIGlmICdyZXN1bHQnIGluIGNla19kZXZfb3BzaTpwcmludChmb3JtYXQpO3ByaW50KCIlcyAgIFslcyElc10gJXNQQVNTV09SRCBIQVMgQ0hBTkdFRCA6KCIlKFAsTSxQLE0pKTtwcmludCgnJykNCiAgICAgICAgZWxzZTpwcmludChmb3JtYXQpDQoNCiMjIyBDaGFuZ2UgUGFzc3dvcmQNCmRlZiBhdXRvX2dhbnRpX3Bhc3MoX3BpeWVfKToNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICBfZ2ltYW5hXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSEFOR0UgT05FIFRBUCBBQ0NPVU5UIFBBU1M/IFtZL25dIDogJyUoSCxQLEgsSykpDQogICAgICAgIGlmIF9naW1hbmFfIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZWxpZiBfZ2ltYW5hXyBpbiBbJzEnLCcwMScsJzAwMScsJ3knLCdZJ106DQogICAgICAgICAgICBvcGVuKCdhdXRvX2dhbnRpLnR4dCcsJ3cnKS53cml0ZSgnWWVzJyk7X25ld3Bhc3NfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIE9ORSBUQVAgUEFTU1dPUkQgOiAnJShILFAsSCxLKSkNCiAgICAgICAgICAgIGlmIGxlbihfbmV3cGFzc18pPDY6cHJpbnQoJyVzIFslcyElc10gJXNTYW5kaSBNaW5pbWFsIDYgS2FyYWt0ZXInJShNLFAsTSxQKSk7dGltZS5zbGVlcCgzKTttZW51KCkNCiAgICAgICAgICAgIGVsc2U6b3BlbignX25ld19wYXNzXy50eHQnLCd3Jykud3JpdGUoX25ld3Bhc3NfKQ0KICAgICAgICAgICAgaWYgX3BpeWVfID09ICdZZXMnOm9wZW4oJ211bmN1bF9vcHNpLnR4dCcsJ3cnKS53cml0ZSgnWWVzJykNCiAgICAgICAgICAgIGVsaWYgX3BpeWVfID09ICdObyc6b3BlbignbXVuY3VsX29wc2kudHh0JywndycpLndyaXRlKCdObycpDQogICAgICAgICAgICBlbHNlOm9wZW4oJ211bmN1bF9vcHNpLnR4dCcsJ3cnKS53cml0ZSgnTm8nKQ0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgZWxpZiBfZ2ltYW5hXyBpbiBbJzInLCcwMicsJzAwMicsJ04nLCduJ106b3BlbignYXV0b19nYW50aS50eHQnLCd3Jykud3JpdGUoJ05vJyk7cGFzcw0KICAgICAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGJyZWFrDQpkZWYgY2hhbmdlX3Bhc3ModXNlcixfcmVxX3Nlc18sX3Jlc3BvbnNlXyxsaW5rXzIpOg0KICAgIGdsb2JhbCBvayxjcA0KICAgIGZpbGVzX29rID0gIk9LLyVzLnR4dCIlKHRhbmdnYWwpDQogICAgdHJ5Ol9uZXdfcGFzc18gPSBvcGVuKCdfbmV3X3Bhc3NfLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBleGNlcHQ6X25ld19wYXNzXyA9ICdhemltdmF1LV8nDQogICAgX3Bhc3N3b3JkXyA9ICcnLmpvaW4oX25ld19wYXNzXyk7X3Jlc3VsdF9va18gPSAiXHIgJXNbJXNLYWNoaS1PSyVzXSAlcyDigKIgJXMlcyVzICAgICAgICAgICIlKEgsUCxILHVzZXIsX3Bhc3N3b3JkXyx0YWh1bih1c2VyKSxQKTtfYnV0dG9uX2Rldl8gPSBbInN1Ym1pdFtZZXNdIiwibmgiLCJmYl9kdHNnIiwiamF6b2VzdCIsImNoZWNrcG9pbnRfZGF0YSJdDQogICAgZm9yIF9hemltdmF1XyBpbiBfcmVzcG9uc2VfKCJpbnB1dCIpOg0KICAgICAgICBpZiBfYXppbXZhdV8uZ2V0KCJuYW1lIikgaW4gX2J1dHRvbl9kZXZfOmRhdGFfY2hhbmdlXzEudXBkYXRlKHtfYXppbXZhdV8uZ2V0KCJuYW1lIik6X2F6aW12YXVfLmdldCgidmFsdWUiKX0pDQogICAgX2dhbnRpX3Bhc3NfID0gX3JlcV9zZXNfLnBvc3QoaG9zdCtsaW5rXzIuZ2V0KCJhY3Rpb24iKSxkYXRhPWRhdGFfY2hhbmdlXzEpLnRleHQ7X3Jlc3VsdF9wYXNzXyA9IHBhcihfZ2FudGlfcGFzc18sImh0bWwucGFyc2VyIik7X2xpbmtfM18gPSBfcmVzdWx0X3Bhc3NfLmZpbmQoImZvcm0iLHsibWV0aG9kIjoicG9zdCJ9KTtfYnV0dG9uX2Rldl9fMl8gPSBbInN1Ym1pdFtOZXh0XSIsIm5oIiwiZmJfZHRzZyIsImphem9lc3QiXQ0KICAgIGlmICJDcmVhdGUgYSBuZXcgcGFzc3dvcmQiIGluIHJlLmZpbmRhbGwoIlw8dGl0bGU+KC4qPyk8XC90aXRsZT4iLHN0cihfZ2FudGlfcGFzc18pKToNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfcmVzdWx0X3Bhc3NfKCJpbnB1dCIpOg0KICAgICAgICAgICAgaWYgX2NpY2lfLmdldCgibmFtZSIpIGluIF9idXR0b25fZGV2X18yXzpkYXRhX2NoYW5nZV8yLnVwZGF0ZSh7X2NpY2lfLmdldCgibmFtZSIpOl9jaWNpXy5nZXQoInZhbHVlIil9KQ0KICAgICAgICBkYXRhX2NoYW5nZV8yLnVwZGF0ZSh7InBhc3N3b3JkX25ldyI6X3Bhc3N3b3JkX30pO19zZXNfZmluYWxfID0gX3JlcV9zZXNfLnBvc3QoaG9zdCtfbGlua18zXy5nZXQoImFjdGlvbiIpLGRhdGE9ZGF0YV9jaGFuZ2VfMik7X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbICIlcz0lcyIgJSAoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSk7X19jb29raWVzX18gPSBjdnRfY29va2llcyhfY29va2llc18pO2Nla19hcGsoX3Jlc3VsdF9va18sX19jb29raWVzX18pO29rLmFwcGVuZCgiJXPigKIlcyIlKHVzZXIsX3Bhc3N3b3JkXykpO19hemltdmF1X2RhcHVudGFfKGZpbGVzX29rLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJSh1c2VyLF9wYXNzd29yZF8pKTtjcCAtPSAxO3Bhc3MNCiAgICBlbHNlOnBhc3MNCg0KIyMjIENoZWNrIEFwcGxpY2F0aW9uDQpkZWYgY2VrX2FwayhoX29rLF9hemltdmF1Xyk6DQogICAgYXBrID0gW107c2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIGNla19waWxpaF9vcHNpID0gb3BlbignbXVuY3VsX29wc2kudHh0JywncicpLnJlYWQoKQ0KICAgIHVybCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2V0dGluZ3MvYXBwcy90YWJiZWQvP3RhYj1hY3RpdmUiO2RhdF9nYW1lID0gc2VzXy5nZXQodXJsLGNvb2tpZXM9eydjb29raWUnOl9hemltdmF1X30pO2RhdGFnYW1lID0gcGFyKGRhdF9nYW1lLmNvbnRlbnQsJ2h0bWwucGFyc2VyJyk7Zm9ybV8gICAgPSBkYXRhZ2FtZS5maW5kKCdmb3JtJyxtZXRob2Q9J3Bvc3QnKQ0KICAgIGZvciBhc3UgaW4gZm9ybV8uZmluZF9hbGwoImgzIik6DQogICAgICAgIHRyeTpjZWxlbmcgPSBhc3UuZmluZCgnc3BhbicpLnRleHQ7YXBrLmFwcGVuZCgnXG4gICDigKIgJytjZWxlbmcpDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdXJsMiA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2V0dGluZ3MvYXBwcy90YWJiZWQvP3RhYj1pbmFjdGl2ZSI7ZGF0X2dhbWUgPSBzZXNfLmdldCh1cmwyLGNvb2tpZXM9eydjb29raWUnOl9hemltdmF1X30pO2RhdGFnYW1lID0gcGFyKGRhdF9nYW1lLmNvbnRlbnQsJ2h0bWwucGFyc2VyJyk7Zm9ybV8gICAgPSBkYXRhZ2FtZS5maW5kKCdmb3JtJyxtZXRob2Q9J3Bvc3QnKQ0KICAgIGZvciBhc3UgaW4gZm9ybV8uZmluZF9hbGwoImgzIik6DQogICAgICAgIHRyeTpjZWxlbmcgPSBhc3UuZmluZCgnc3BhbicpLnRleHQ7YXBrLmFwcGVuZCgnXG4gICDigKIgJytjZWxlbmcpDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgaWYgY2VrX3BpbGloX29wc2kgPT0gJ1llcyc6cHJpbnQoaF9vaysnJy5qb2luKGFwaykpO3ByaW50KCcnKQ0KICAgIGVsaWYgY2VrX3BpbGloX29wc2kgPT0gJ05vJzpwcmludChoX29rKycnLmpvaW4oYXBrKSkNCg0KIyMjIENoZWNrIFllYXIgb2YgTWFudWZhY3R1cmUNCmRlZiB0YWh1bihmeCk6DQogICAgaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIoZngpKSk6dGFodW56PScnDQogICAgZWxzZToNCiAgICAgICAgaWYgbGVuKGZ4KT09MTU6DQogICAgICAgICAgICBpZiBmeFs6MTBdIGluIFsnMTAwMDAwMDAwMCddICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDA5Jw0KICAgICAgICAgICAgZWxpZiBmeFs6OV0gaW4gWycxMDAwMDAwMDAnXSAgICAgICA6dGFodW56ID0gJyDigKIgMjAwOScNCiAgICAgICAgICAgIGVsaWYgZnhbOjhdIGluIFsnMTAwMDAwMDAnXSAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMDknDQogICAgICAgICAgICBlbGlmIGZ4Wzo3XSBpbiBbJzEwMDAwMDAnLCcxMDAwMDAxJywnMTAwMDAwMicsJzEwMDAwMDMnLCcxMDAwMDA0JywnMTAwMDAwNSddOnRhaHVueiA9ICcg4oCiIDIwMDknDQogICAgICAgICAgICBlbGlmIGZ4Wzo3XSBpbiBbJzEwMDAwMDYnLCcxMDAwMDA3JywnMTAwMDAwOCcsJzEwMDAwMDknXTp0YWh1bnogPSAnIOKAoiAyMDEwJw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDEnXSAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxMC8yMDExJw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDInLCcxMDAwMDMnXSA6dGFodW56ID0gJyDigKIgMjAxMS8yMDEyJw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDQnXSAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxMi8yMDEzJw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDUnLCcxMDAwMDYnXSA6dGFodW56ID0gJyDigKIgMjAxMy8yMDE0Jw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDcnLCcxMDAwMDgnXSA6dGFodW56ID0gJyDigKIgMjAxNC8yMDE1Jw0KICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDknXSAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxNScNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDEnXSAgICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTUvMjAxNicNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDInXSAgICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTYvMjAxNycNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDMnXSAgICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTgvMjAxOScNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDQnXSAgICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTkvMjAyMCcNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDUnXSAgICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMjAnDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDA2JywnMTAwMDcnLCcxMDAwOCddOnRhaHVueiA9ICcg4oCiIDIwMjEnDQogICAgICAgICAgICBlbHNlOnRhaHVuej0nJw0KICAgICAgICBlbGlmIGxlbihmeCkgaW4gWzksMTBdOnRhaHVueiA9ICcg4oCiIDIwMDgvMjAwOScNCiAgICAgICAgZWxpZiBsZW4oZngpPT04OnRhaHVueiA9ICcg4oCiIDIwMDcvMjAwOCcNCiAgICAgICAgZWxpZiBsZW4oZngpPT03OnRhaHVueiA9ICcg4oCiIDIwMDYvMjAwNycNCiAgICAgICAgZWxzZTp0YWh1bno9JycNCiAgICByZXR1cm4gdGFodW56DQoNCiMjIyBDb252ZXJ0IENvb2tpZXMNCmRlZiBjdnRfY29va2llcyhyYXdfY29va2llcyk6DQogICAgbyA9IHt9DQogICAgIyBfcmF3X2Nvb2tpZXNfd2FydmVzdF8gPSBjX3VzZXIsZGF0cixkbm9uY2UsZnIsc2IseHMNCiAgICAjIF9yYXdfY29va2llc19hYXBfICAgICA9IGNfdXNlcixmcixzYix4cyxkYXRyDQogICAgIyBfY29va2VkX2Nvb2tpZXNfICAgICAgPSBzYixkYXRyLGNfdXNlcix4cyxmcg0KICAgIGtpa28gPSByYXdfY29va2llcy5yZXBsYWNlKCcgJywnJykuc3BsaXQoJzsnKQ0KICAgIGZvciB4IGluIGtpa286DQogICAgICAgIHkgPSB4LnNwbGl0KCc9JylbMF0NCiAgICAgICAgeiA9IHguc3BsaXQoJz0nKVsxXQ0KICAgICAgICBvLnVwZGF0ZSh7eTp6fSkNCiAgICBjb29rZWRfY29va2llcyA9ICgnc2I9JXM7IGRhdHI9JXM7IGNfdXNlcj0lczsgeHM9JXM7IGZyPSVzJyUob1snc2InXSxvWydkYXRyJ10sb1snY191c2VyJ10sb1sneHMnXSxvWydmciddKSkNCiAgICAjX2Nvb2tpZXNfID0geydjb29raWUnOmNvb2tlZF9jb29raWVzfQ0KICAgICNwcmludChjb29rZWRfY29va2llcykNCiAgICByZXR1cm4gY29va2VkX2Nvb2tpZXMNCg0KIyMjIE1ldG9kZSBDcmFjaw0KZGVmIHBpbGloX21ldGhvZGUoKToNCiAgICB0cnk6b3MucmVtb3ZlKCdtZXRob2QudHh0JykNCiAgICBleGNlcHQ6cGFzcw0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIHN0YXJ0X21ldGhvZCgpDQogICAgICAgIHB1dCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICAgICAgaWYgcHV0IGluIFsnJywnICcsJyAgJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWycxJywnMDEnLCcwMDEnLCdhJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfYXBpX3YxJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWycyJywnMDInLCcwMDInLCdiJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfYXBpX3YyJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWyczJywnMDMnLCcwMDMnLCdjJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWyc0JywnMDQnLCcwMDQnLCdkJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YyJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbW9iaWxlX3YxJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxpZiBwdXQgaW4gWyc2JywnMDYnLCcwMDYnLCdmJ106Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbW9iaWxlX3YyJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgZWxzZTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tYmFzaWNfdjEnKTtjb2suY2xvc2UoKQ0KICAgICAgICBicmVhaw0KDQojIyMgQ3JhY2sNCmNsYXNzIGNyYWNrOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLGZpbGVzKToNCiAgICAgICAgZ2xvYmFsIG9rLGNwDQogICAgICAgIHNlbGYuYWRhID0gb2s7c2VsZi5jcCA9IGNwO3NlbGYua28gPSAwDQogICAgICAgIHNlbGYuX2hheW9fbWF1X3JlY29kZV8gPSAiMTIzNDUiDQogICAgICAgIGlmIGxlbihzZWxmLl9oYXlvX21hdV9yZWNvZGVfKSA9PSA1OnBhc3MNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHRyeTpvcy5yZW1vdmUoZmlsZXMpDQogICAgICAgICAgICBleGNlcHQ6cHJpbnQoIkZVQ0siKQ0KICAgICAgICB0cnk6b3MucmVtb3ZlKCdvcHRpb25fLnR4dCcpDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIGNpayA9IG9wZW4oJ29wdGlvbl8udHh0JywndycpO2Npay53cml0ZSgnbnVsbCcpO2Npay5jbG9zZSgpDQogICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICBwaWxpaF9tZXRob2RlKCk7cHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVz4oCiJXNdICVzQ1JBQ0sgV0lUSCBERUZBVUxUIC8gTUFOVUFMIFBBU1NXT1JEICVzWyVzZCVzLyVzbSVzXSclKEgsUCxILEIsUCxILFAsSyxQKSkNCiAgICAgICAgICAgIF9waWxpaF9zYW5kaV8gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiBfcGlsaWhfc2FuZGlfPT0iIjpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgZWxpZiBfcGlsaWhfc2FuZGlfIGluIFsnbScsJ00nLCcyJywnMDInLCcwMDInXToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5hcGsgPSBmaWxlcztzZWxmLmZzID0gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCAoIiAgICVzIiUoZSkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuZmwgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgoIiAgICVzIiVlKSk7Y29udGludWUNCiAgICAgICAgICAgICAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzQW1lcmljYSwxMjM0NTYsMTAyMDMwJyUoSCxQLEgsSyxIKSk7c2VsZi5wd2xpc3QoKTticmVhaw0KICAgICAgICAgICAgZWxpZiBfcGlsaWhfc2FuZGlfIGluIFsnZCcsJ0QnLCcxJywnMDEnLCcwMDEnXToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5hcGsgPSBmaWxlcztzZWxmLmZzID0gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCAoIiAgICVzIiUoZSkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuZmwgPSBbXTtzdGFydF9tZXRob2RlenooKTtrb3BpID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKQ0KICAgICAgICAgICAgICAgICAgICBpZiBrb3BpIGluIFsnJ106DQogICAgICAgICAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpDQogICAgICAgICAgICAgICAgICAgICAgICBtZW51KCkNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrb3BpIGluIFsnMScsJzAxJ106DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCLigKIiKVswXSwicHciOmdlbmVyYXRlMShpLnNwbGl0KCLigKIiKVsxXSl9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIGtvcGkgaW4gWycyJywnMDInXToNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdLCJwdyI6Z2VuZXJhdGUyKGkuc3BsaXQoIuKAoiIpWzFdKX0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzMnLCcwMyddOg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgi4oCiIilbMF0sInB3IjpnZW5lcmF0ZTMoaS5zcGxpdCgi4oCiIilbMV0pfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrb3BpIGluIFsnNCcsJzA0J106DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6b3MucmVtb3ZlKCdwYXNzLnR4dCcpDQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Om9zLnJlbW92ZSgnZGlnaXRwYXNzLnR4dCcpDQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgdGFtYmFoX3Bhc3MoKTt0YW1iYWhfcGFzc19hbmdrYSgpDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCLigKIiKVswXSwicHciOmdlbmVyYXRlNChpLnNwbGl0KCLigKIiKVsxXSl9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICAgICAgICAgIHRyeTpvcy5yZW1vdmUoJ2NwX29wdGlvbi50eHQnKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgICAgICBwcmludCgnJXMgJyUoTykpO3B1ZiA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNCUklORyBVUCBDUCBPUFRJT05TPyBbWS9uXSA6ICclKEgsUCxILEspKQ0KICAgICAgICAgICAgICAgICAgICBpZiBwdWYgaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIHB1ZiBpbiBbJzEnLCcwMScsJzAwMScsJ3knLCdZJ106YXV0b19nYW50aV9wYXNzKCdZZXMnKTtjb2sgPSBvcGVuKCdjcF9vcHRpb24udHh0JywndycpO2Nvay53cml0ZSgnb3BzaV9jcCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5zdGFydF9jcmFjayxzZWxmLmZsKTtvcy5yZW1vdmUoc2VsZi5hcGspO19jaWNpX2NpY2lfKCk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBwdWYgaW4gWycyJywnMDInLCcwMDInLCduJywnTiddOmF1dG9fZ2FudGlfcGFzcygnTm8nKTtjb2sgPSBvcGVuKCdjcF9vcHRpb24udHh0JywndycpO2Nvay53cml0ZSgnbnVsbCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5zdGFydF9jcmFjayxzZWxmLmZsKTtvcy5yZW1vdmUoc2VsZi5hcGspO19jaWNpX2NpY2lfKCk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgoIiAgICVzIiVlKSkNCiAgICBkZWYgcHdsaXN0KHNlbGYpOg0KICAgICAgICBzZWxmLnB3ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBBU1NXT1JEIDogJyUoSyxQLEssSCkpLnNwbGl0KCIsIikNCiAgICAgICAgaWYgbGVuKHNlbGYucHcpID09MDpzZWxmLnB3bGlzdCgpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZsOmkudXBkYXRlKHsicHciOnNlbGYucHd9KQ0KICAgICAgICAgICAgdHJ5Om9zLnJlbW92ZSgnY3Bfb3B0aW9uLnR4dCcpDQogICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgcHJpbnQoJyVzICclKE8pKTtwdWYgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzUE9QIFVQIENQIE9QVElPTlM/IFtZL25dIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiBwdWYgaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgZWxpZiBwdWYgaW4gWycxJywnMDEnLCcwMDEnLCd5JywnWSddOmF1dG9fZ2FudGlfcGFzcygnWWVzJyk7Y29rID0gb3BlbignY3Bfb3B0aW9uLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ29wc2lfY3AnKTtjb2suY2xvc2UoKTtzdGFydGVkKCk7VGhyZWFkUG9vbCgzMCkubWFwKHNlbGYuc3RhcnRfY3JhY2ssc2VsZi5mbCk7b3MucmVtb3ZlKHNlbGYuYXBrKTtfY2ljaV9jaWNpXygpDQogICAgICAgICAgICBlbGlmIHB1ZiBpbiBbJzInLCcwMicsJzAwMicsJ24nLCdOJ106YXV0b19nYW50aV9wYXNzKCdObycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCd3Jyk7Y29rLndyaXRlKCdudWxsJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzApLm1hcChzZWxmLnN0YXJ0X2NyYWNrLHNlbGYuZmwpO29zLnJlbW92ZShzZWxmLmFwayk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGRlZiBzdGFydF9jcmFjayhzZWxmLGZsKToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgbWV0b2RlID0gb3BlbignbWV0aG9kLnR4dCcsJ3InKS5yZWFkKCkNCiAgICAgICAgICAgIGZvciBpIGluIGZsLmdldCgicHciKToNCiAgICAgICAgICAgICAgICBpZiAnbWV0aG9kZV9hcGlfdjEnIGluIG1ldG9kZTpsb2cgPSBsb2dfYXBpXzEoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxpZiAnbWV0aG9kZV9hcGlfdjInIGluIG1ldG9kZTpsb2cgPSBsb2dfYXBpXzIoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxpZiAnbWV0aG9kZV9tYmFzaWNfdjEnIGluIG1ldG9kZTpsb2cgPSBsb2dfbWJhc2ljXzEoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxpZiAnbWV0aG9kZV9tYmFzaWNfdjInIGluIG1ldG9kZTpsb2cgPSBsb2dfbWJhc2ljXzIoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxpZiAnbWV0aG9kZV9tb2JpbGVfdjEnIGluIG1ldG9kZTpsb2cgPSBsb2dfbW9iaWxlXzEoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxpZiAnbWV0aG9kZV9tb2JpbGVfdjInIGluIG1ldG9kZTpsb2cgPSBsb2dfbW9iaWxlXzIoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgZWxzZTpsb2cgPSBsb2dfbWJhc2ljXzEoZmwuZ2V0KCJpZCIpLGkpDQogICAgICAgICAgICAgICAgaWYgbG9nLmdldCgic3RhdHVzIik9PSJjcCI6DQogICAgICAgICAgICAgICAgICAgIGZpbGVzX2NwID0gIktSSVNITkEtQ1AvJXMudHh0IiUodGFuZ2dhbCkNCiAgICAgICAgICAgICAgICAgICAgaWYgZmwuZ2V0KCJpZCIpIGluIGZpbGVzX2NwOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTprZSA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIiArIGZsLmdldCgiaWQiKSArICI/ZmllbGRzPW5hbWUsaWQsYmlydGhkYXksZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0iICsgX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsInIiKS5yZWFkKCkpO3R0ID0gX2pzX2xvXyhrZS50ZXh0KTt0dGwgPSB0dFsiYmlydGhkYXkiXTttLGQseSA9IHR0bC5zcGxpdCgiLyIpO20gPSBidWxhbl90dGxbbV07dHRsbCA9ICgnIOKAoiAlcyAlcyAlcyclKGQsbSx5KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDp0dGxsID0gKCcnJSgpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaF9jcCA9ICJcciAlc1slc0tSSVNITkEtQ1Alc10gJXMg4oCiICVzJXMlcyAgICAgICAgICAiJShLLFAsSyxmbC5nZXQoImlkIiksaSx0dGxsLHRhaHVuKGZsLmdldCgiaWQiKSkpO2Nla19vcHNpKGZsLmdldCgiaWQiKSxpLGhfY3ApDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNwLmFwcGVuZCgiJXPigKIlcyIlKGZsLmdldCgiaWQiKSxpKSk7X2F6aW12YXVfZGFwdW50YV8oZmlsZXNfY3AsImErIikud3JpdGUoIiVz4oCiJXMlc1xuIiUoZmwuZ2V0KCJpZCIpLGksdHRsbC5yZXBsYWNlKCcgJywnJykpKTticmVhaw0KICAgICAgICAgICAgICAgIGVsaWYgbG9nLmdldCgic3RhdHVzIik9PSJvayI6DQogICAgICAgICAgICAgICAgICAgIGZpbGVzX29rID0gIktSSVNITkEtT0svJXMudHh0IiUodGFuZ2dhbCkNCiAgICAgICAgICAgICAgICAgICAgaWYgZmwuZ2V0KCJpZCIpIGluIGZpbGVzX29rOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdtZXRob2RlX21iYXNpY192MScgaW4gbWV0b2RlIG9yICdtZXRob2RlX21iYXNpY192MicgaW4gbWV0b2RlIG9yICdtZXRob2RlX21vYmlsZV92MScgaW4gbWV0b2RlIG9yICdtZXRob2RlX21vYmlsZV92MicgaW4gbWV0b2RlOmhfb2sgPSAiXHIgJXNbJXNLUklTSE5BLU9LJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSCxQLEgsZmwuZ2V0KCJpZCIpLGksdGFodW4oZmwuZ2V0KCJpZCIpKSxQKTtjZWtfYXBrKGhfb2ssY3Z0X2Nvb2tpZXMobG9nLmdldCgiY29va2llcyIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6cHJpbnQoIlxyICVzWyVzS1JJU0hOQS1PSyVzXSAlcyDigKIgJXMlcyAgICAgICAgICAiJShILFAsSCxmbC5nZXQoImlkIiksaSx0YWh1bihmbC5nZXQoImlkIikpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRhLmFwcGVuZCgiJXPigKIlcyIlKGZsLmdldCgiaWQiKSxpKSk7X2F6aW12YXVfZGFwdW50YV8oZmlsZXNfb2ssImErIikud3JpdGUoIiVz4oCiJXNcbiIlKGZsLmdldCgiaWQiKSxpKSk7YnJlYWsNCiAgICAgICAgICAgICAgICBlbHNlOmNvbnRpbnVlDQogICAgICAgICAgICBzZWxmLmtvKz0xDQogICAgICAgICAgICBwcmludCgiXHIgJXNbJXNDUkFDSyVzXVslcyVzLyVzJXNdWyVzLU9LOiVzJXNdWyVzLUNQOiVzJXNdJXMiJShLLEgsSyxQLHNlbGYua28sbGVuKHNlbGYuZmwpLEssUCxsZW4oc2VsZi5hZGEpLEssUCxsZW4oc2VsZi5jcCksSyxQKSwgZW5kPScnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgZXhjZXB0OnNlbGYuc3RhcnRfY3JhY2soZmwpDQoNCg0KIyMjIEdldCBUYXJnZXQgTnVtYmVyIG9mIEZyaWVuZHMNCmRlZiB0ZW1hbl90YXJnZXQoKToNCiAgICBpdCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNUQVJHRVQgSUQgOiVzICclKEgsUCxILEssSCkpDQogICAgdHJ5OnRva2VuID0gX2F6aW12YXVfZGFwdW50YV8oJ3Rva2VuLnR4dCcsJ3InKS5yZWFkKCk7bW0gPSBfcmVxX2dldF8oJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyclKGl0LHRva2VuKSk7bm4gPSBfanNfbG9fKG1tLnRleHQpO3ByaW50ICgnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzJyUoSCxQLEgsSyxublsnbmFtZSddKSkNCiAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOmphbGFuKCclcyBbJXMhJXNdICVzVE9LRU4vQ09PS0lFUyBJTlZBTElEJyUoTSxQLE0sUCkpO21lbnVfbG9nKCkNCiAgICB0dD1bXTt0ZT1bXTtsaW0gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRFVNUCBMSU1JVCA6ICVzJyUoSCxQLEgsSyxIKSk7cHJpbnQoJyVzICVzJyUoTyxQKSk7YWRhID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9mcmllbmRzP2xpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyclKGl0LGxpbSx0b2tlbikpO2lkaSA9IF9qc19sb18oYWRhLnRleHQpDQogICAgZm9yIHggaW4gaWRpWydkYXRhJ106dHQuYXBwZW5kKHhbJ2lkJ10pDQogICAgZm9yIGlkIGluIHR0Og0KICAgICAgICB0cnk6DQogICAgICAgICAgICBhZGEyID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9mcmllbmRzP2FjY2Vzc190b2tlbj0lcyclKGlkLHRva2VuKSk7aWRpMiA9IF9qc19sb18oYWRhMi50ZXh0KQ0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGZvciBiIGluIGlkaTJbJ2RhdGEnXTp0ZS5hcHBlbmQoYlsnaWQnXSkNCiAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjpwcmludCgnIFshXSBQUklWQVRFJykNCiAgICAgICAgICAgIHByaW50KCcgW+KAol0nLGlkLCfigKInLGxlbih0ZSkpO3RlLmNsZWFyKCkNCiAgICAgICAgZXhjZXB0IEtleUVycm9yOnByaW50KCclcyBbIV0gU1BBTSBBQ0NPVU5ULi4uISclKE0pKQ0KICAgIHByaW50KCcgJyk7X2NpY2lfYXppbXZhdV8oJyBbIEJBQ0sgXScpO21lbnUoKQ0KDQojIyMgTWVudSBDaGVja2luZyBDcmFjayByZXN1bHQNCmRlZiByZXN1bHQoKToNCiAgICBjbGVhcigpDQogICAgYmFubmVyKCkNCiAgICBqYWxhbignJXMgWyAlc0NSQUNLIFJFU1VMVFMgJXNdJyUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpO3ByaW50KCclcyBbJXMxJXNdICVzQ0hFQ0sgUkVTVUxUUyBPSyclKEgsUCxILEspKTtwcmludCgnJXMgWyVzMiVzXSAlc0NIRUNLIFJFU1VMVFMgQ1AnJShILFAsSCxQKSk7Y2ggPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyUoSCxQLEgsSykpDQogICAgaWYgY2ggaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGVsaWYgY2ggaW4gWycxJywnMDEnLCcwMDEnLCdhJ106DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIG9rbCA9IG9zLmxpc3RkaXIoIktSSVNITkEtT0siKTtwcmludCgnJXMgJyUoTykpO3ByaW50KCclcyBbJXMgQ1JBQ0sgUkVTVUxUUyBTVE9SRUQgSU4gT0sgRklMRSAlc10nJShILFAsSCkpO3ByaW50KCclcyAnJShPKSkNCiAgICAgICAgICAgIGZvciBmaWxlIGluIG9rbDpwcmludCgnJXMgWyVz4oCiJXNdICVzJXMnJShILFAsSCxLLGZpbGUpKQ0KICAgICAgICAgICAgcHJpbnQoJyVzICclKE8pKTtmaWxlcyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBGSUxFIE5BTUUgOiAnJShILFAsSCxLKSk7cHJpbnQoJycpDQogICAgICAgICAgICBpZiBmaWxlcyA9PSAiIjpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO3Jlc3VsdCgpDQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgcHBwID0gX2F6aW12YXVfZGFwdW50YV8oIktSSVNITkEtT0svJXMiJShmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6eXl5ID0geC5yZXBsYWNlKCfigKInLCcg4oCiICcpO3ByaW50KCcgJXNbJXNLUklTSE5BLU9LJXNdICVzJyUoSCxQLEgseXl5KSkNCiAgICAgICAgICAgICAgICBkZWwxID0gKCIlcyIlKGZpbGVzKSkucmVwbGFjZSgiLSIsICIgIikucmVwbGFjZSgiLnR4dCIsICIiKTtwcmludCgnXG4lcyBbJXPigKIlc10gJXNUT1RBTCBDUkFDSyBSRVNVTFQgREFURSAlcyBJUyAlcyBBQ0NPVU5UJyUoSCxQLEgsSyxkZWwxLGxlbihwcHApKSkNCiAgICAgICAgICAgIGV4Y2VwdDpwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyUoTSxQLE0pKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KCclcyBbJXMgTk8gUkVTVUxUUyBGT1VORCAlc10nJShNLFAsTSkpDQogICAgZWxpZiBjaCBpbiBbJzInLCcwMicsJzAwMicsJ2InXToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgY3BsID0gb3MubGlzdGRpcigiS1JJU0hOQS1DUCIpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslcyBDUkFDSyBSRVNVTFRTIFNUT1JFRCBJTiBDUCBGSUxFUyAlc10nJShILFAsSCkpO3ByaW50KCclcyAnJShPKSkNCiAgICAgICAgICAgIGZvciBmaWxlIGluIGNwbDpwcmludCgnJXMgWyVz4oCiJXNdICVzJXMnJShILFAsSCxLLGZpbGUpKQ0KICAgICAgICAgICAgcHJpbnQoJyVzICclKE8pKTtmaWxlcyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBGSUxFIE5BTUUgOiAnJShILFAsSCxLKSk7cHJpbnQoJycpDQogICAgICAgICAgICBpZiBmaWxlcyA9PSAiIjpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO3Jlc3VsdCgpDQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgcHBwID0gX2F6aW12YXVfZGFwdW50YV8oIktSSVNITkEtQ1AvJXMiJShmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6eXl5ID0geC5yZXBsYWNlKCfigKInLCcg4oCiICcpO3ByaW50KCcgJXNbJXNLUklTSE5BLUNQJXNdICVzJyUoSyxQLEsseXl5KSkNCiAgICAgICAgICAgICAgICBkZWwxID0gKCIlcyIlKGZpbGVzKSkucmVwbGFjZSgiLSIsICIgIikucmVwbGFjZSgiLnR4dCIsICIiKTtwcmludCgnXG4lcyBbJXPigKIlc10gJXNUT1RBTCBDUkFDSyBSRVNVTFQgREFURSAlcyBJUyAlcyBBQ0NPVU5UJyUoSCxQLEgsUCxkZWwxLGxlbihwcHApKSkNCiAgICAgICAgICAgIGV4Y2VwdDpwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyUoUCxNLE0pKQ0KICAgICAgICBleGNlcHQ6cHJpbnQoJyVzIFslcyBOTyBSRVNVTFRTIEZPVU5EICVzXSclKFAsTSxQKSkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpDQogICAgcHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQoNCmRlZiBjZWtfcmVzdWx0KCk6DQogICAgdHJ5Om9zLnJlbW92ZSgnb3B0aW9uXy50eHQnKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgY2lrID0gb3Blbignb3B0aW9uXy50eHQnLCd3Jyk7Y2lrLndyaXRlKCdyZXN1bHQnKTtjaWsuY2xvc2UoKQ0KICAgIHByaW50KCclcyBbICVzQ0hFQ0sgQ1JBQ0sgUkVTVUxUIEFDQ09VTlQgT1BUSU9OUyAlc10nJShILEssSCkpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgRklMRSA6ICVzLnR4dCclKEgsUCxILEssdGFuZ2dhbCkpO2ZpbGVzX18gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRmlsZSA6ICclKEgsUCxILEspKTtmaWxlcyA9ICJDUC8iK2ZpbGVzX18NCiAgICB0cnk6YnVrYV9iYWp1ID0gX2F6aW12YXVfZGFwdW50YV8oZmlsZXMsInIiKS5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOnByaW50KCIlcyBbJXMhJXNdICVzRklMRSBOT1QgRVhJU1RJTkciJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTsgbWVudSgpDQogICAgYXV0b19nYW50aV9wYXNzKCdZZXMnKTtwcmludCgiJXMgWyVz4oCiJXNdICVzVE9UQUwgQUNDT1VOVFMgOiAlcyVzIiUoSCxQLEgsSyxILHN0cihsZW4oYnVrYV9iYWp1KSkpKTtwcmludCgiIikNCiAgICBmb3IgbWVtZWsgaW4gYnVrYV9iYWp1Og0KICAgICAgICBpZiAnw6LigqzCoicgaW4gbWVtZWs6bWVtZWsgPSBtZW1lay5yZXBsYWNlKCfDouKCrMKiJywn4oCiJykNCiAgICAgICAga29udG9sID0gbWVtZWsucmVwbGFjZSgi4oCiIiwiIOKAoiAiKTt0aXRpZCAgPSBtZW1lay5zcGxpdCgi4oCiIikNCiAgICAgICAgX2Zvcm1hdF8gPSAiXHIgJXNbJXNLUklTSE5BLUNQJXNdICVzICAgICAgICAgICIlKEssUCxLLGtvbnRvbCkNCiAgICAgICAgdHJ5OmNla19vcHNpKHRpdGlkWzBdLHRpdGlkWzFdLF9mb3JtYXRfKQ0KICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICBwcmludCgiIik7cHJpbnQoJyVzIFslc+KAoiVzXSAlc0NIRUNLSU5HIFBST0NFU1MgQ09NUExFVEUnJShILFAsSCxLKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQoNCg0KIyMjIFRleHQgVmFyaWF0aW9ucw0KZGVmIHZhcl9tZW51KCk6DQogICAgcHJpbnQoJyVzICAgICAgICAgIFsgJXNDSE9PU0UgTE9HSU4gTUVUSE9EICVzXSclKFosSyxaKSkNCiAgICBwcmludCgnJykNCiAgICBwcmludCgnJXMgWyVzMSVzXSAlc0xPR0lOIFdJVEggVE9LRU4gWyVzTElNSVRFRCBBQ0NFU1Mlc10nJShILFAsSCxQLE0sUCkpDQogICAgcHJpbnQoJyVzIFslczIlc10gJXNMT0dJTiBXSVRIIENPT0tJRVMgWyVzVU5MSU1JVEVEIEFDQ0VTUyVzXSclKEgsUCxILFAsSCxQKSkNCiAgICBwcmludCgnJXMgWyVzMCVzXSAlc0VYSVQnJShILFAsSCxNKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgDQogICAgDQpkZWYgdmFyX3VnZW4oKToNCiAgICBwcmludCgiJXMgWyVzMSVzXSAlc0dFVCBVU0VSIEFHRU5UIiUoSCxQLEgsSCkpDQogICAgcHJpbnQoIiVzIFslczIlc10gJXNDSEFOR0UgVVNFUiBBR0VOVCAlcyglc01BTlVBTCVzKSIlKEgsUCxILFAsQixILEIpKQ0KICAgIHByaW50KCIlcyBbJXMzJXNdICVzQ0hBTkdFIFVTRVIgQUdFTlQgJXMoJXNBREpVU1QgSFAlcykiJShILFAsSCxQLEIsSyxCKSkNCiAgICBwcmludCgiJXMgWyVzNCVzXSAlc0RFTEVURSBVU0VSIEFHRU5UIiUoSCxQLEgsTSkpDQogICAgcHJpbnQoIiVzIFslczUlc10gJXNDSEVDSyBVU0VSIEFHRU5UIiUoSCxQLEgsSykpDQogICAgcHJpbnQoIiVzIFslczAlc10gJXNCQUNLIiUoSCxQLEgsTSkpDQoNCmRlZiBzdGFydF9tZXRob2QoKToNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgcHJpbnQoJyVzIFslczElc10gJXMgQVBJIE1FVEhPRCBWMSclKEgsUCxILE0pKQ0KICAgIHByaW50KCclcyBbJXMyJXNdICVzIEFQSSBNRVRIT0QgVjInJShILFAsSCxCKSkNCiAgICBwcmludCgnJXMgWyVzMyVzXSAlcyBNQkFTSUMgTUVUSE9EIFYxJyUoSCxQLEgsSCkpDQogICAgcHJpbnQoJyVzIFslczQlc10gJXMgTUJBU0lDIE1FVEhPRCBWMiclKEgsUCxILEspKQ0KICAgIHByaW50KCclcyBbJXM1JXNdICVzIE1PQklMRSBNRVRIT0QgVjEnJShILFAsSCxPKSkNCiAgICBwcmludCgnJXMgWyVzNiVzXSAlcyBNT0JJTEUgTUVUSE9EIFYyJyUoSCxQLEgsUCkpDQoNCmRlZiBzdGFydF9tZXRob2RlenooKToNCiAgICBwcmludCgiIikNCiAgICBwcmludCgnJXMgWyVzMSVzXSAlc0ZBU1QgQ1JBQ0sgJXNbJXNGRVcgUkVTVUxUUyVzXSclKEgsUCxILE8sTyxNLE8pKQ0KICAgIHByaW50KCclcyBbJXMyJXNdICVzU0xPVyBDUkFDSyAlc1slc1JFQ09NTUVOREVEJXNdJyUoSCxQLEgsTyxPLEgsTykpDQogICAgcHJpbnQoJyVzIFslczMlc10gJXNWRVJZIFNMT1cgQ1JBQ0sgJXNbJXNNT1JFIFJFU1VMVFMlc10nJShILFAsSCxPLE8sQixPKSkNCiAgICBwcmludCgnJXMgWyVzNCVzXSAlc0NPTUJJTkVEIFBBU1NXT1JEIENSQUNLJyUoSCxQLEgsSykpDQogICAgcHJpbnQoIiIpDQogICAgDQogICAgDQpkZWYgc3RhcnRlZCgpOg0KICAgIHByaW50KCIiKQ0KICAgIHByaW50KCIgICAgICVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiIlKEgsTSxCLEssVSxPLEssSCxNLEIsSyxVLE8sSyxILE0sQixLKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzQ1JBQ0tTIElOIFBST0dSRVNTLi4uJyUoSCxNLEgsSCkpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1slc09LJXNdIElEUyBTQVZFRCBJTiA+PiAlc0tSSVNITkEtT0svJXMudHh0JyUoSCxCLEgsTyxILE8sSCx0YW5nZ2FsKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzWyVzQ1Alc10gSURTIFNBVkVEIElOID4+ICVzS1JJU0hOQS1DUC8lcy50eHQnJShILEssSCxPLE0sTyxNLHRhbmdnYWwpKQ0KICAgIHBzYignJXMgWyVz4oCiJXNdICVzT04gRkxJR0hUIE1PREUgRk9SIFs1IFNFQ10gRVZFUlkgNSBNSU5VVEVTXG4nJShILFAsSCxCKSkNCg0KDQpkZWYgZm9sZGVyKCk6DQogICAgdHJ5Om9zLm1rZGlyKCJLUklTSE5BLUNQIikNCiAgICBleGNlcHQ6cGFzcw0KICAgIHRyeTpvcy5ta2RpcigiS1JJU0hOQS1PSyIpDQogICAgZXhjZXB0OnBhc3MNCg0KDQpkZWYgZ2Vua2V5KCk6DQoJdHJ5Og0KCQlybiA9IG9wZW4oJy9kYXRhL2RhdGEvY29tLnRlcm11eC9maWxlcy91c3IvYmluLy5sbHZtLWNvdicsICdyJykucmVhZCgpDQoJCXJiID0gcm4rYmFzZXNwbGl0DQoJCWJhbm5lcigpDQoJCXBzYignICAgICAgICVz44CLJXPjgIslc+OAiyVzVEhJUyBUT09MIElTIFBBSUQlc+OAiiVz44CKJXPjgIonJShNLEgsQixILEIsSCxNKSkNCgkJcHJpbnQoIlxuXDAzM1swOzkxbSAgICAgICAgICAgWU9VIEFSRSBOT1QgUFJFTUlVTSBVU0VSICIpDQoJCXByaW50KCJcMDMzWzA7OTFtICAgICAgICBGSVJTVCBCVVkgUFJFTUlVTSBLRVkgRlJPTSBPV05FUiIpDQoJCXByaW50KCJcMDMzWzA7OTFtLiAgICAgICAgICBQQVlNRU5UIENBTlQgQkUgVU5ET05FIikNCgkJcHJpbnQoIlwwMzNbMDs5MW0uICAgICAgICAgIENIQU5HRSBVU0VSIEFHRU5UIElGIENQIElEUyBDQU1FIikNCgkJcHJpbnQoIlwwMzNbMDs5M20gICAgICAgICAgICBTRU5EIFRISVMgS0VZIFRPIE9XTkVSIFxuXG4gICBZT1VSIEtFWSA6IFwwMzNbMDs5Mm0lcyIlKHJiKSkNCgkJcHJpbnQoIlwwMzNbMDs5M20gICBUT09MIFBSSUNFIDogJXMxNTAgIiUoSCkpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgVkFMSURJVFkgOiAlczEgbW9udGgiJShIKSkNCgkJc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoWyJhbSIsICJzdGFydCIsICJodHRwczovL3dhLm1lLys5MjMxMzA5OTczNzgiXSkNCgkJZXhpdCgpDQoJZXhjZXB0KElPRXJyb3IpOg0KCQlyYiA9IHJ4DQoJCW9wZW4oIi9kYXRhL2RhdGEvY29tLnRlcm11eC9maWxlcy91c3IvYmluLy5sbHZtLWNvdiIsInciKS53cml0ZShyYikNCgkJb3Muc3lzdGVtKCJjaG1vZCA3NzcgL2RhdGEvZGF0YS9jb20udGVybXV4L2ZpbGVzL3Vzci9iaW4vLmxsdm0tY292IikNCgkJYmFubmVyKCkNCgkJcHNiKCcgICAgICAgJXPjgIslc+OAiyVz44CLJXNQT1dFUiBPRiBLUklTSE5BJXPjgIolc+OAiiVz44CKJyUoTSxILEIsSCxCLEgsTSkpDQoJCXByaW50KCJcblwwMzNbMDs5MW0gICAgICAgICAgICAgIFlPVSBBUkUgTk9UIFBSRU1JVU0gVVNFUiAiKQ0KCQlwcmludCgiXDAzM1swOzkxbSAgICAgICAgICAgRklSU1QgQlVZIFBSRU1JVU0gS0VZIEZST00gT1dORVIiKQ0KCQlwcmludCgiXDAzM1swOzkxbS4gICAgICAgICAgUEFZTUVOVCBDQU5UIEJFIFVORE9ORSIpDQoJCXByaW50KCJcMDMzWzA7OTFtLiAgICAgICAgICBDSEFOR0UgVVNFUiBBR0VOVCBJRiBDUCBJRFMgQ0FNRSIpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgICAgICAgICAgICAgU0VORCBUSElTIEtFWSBUTyBPV05FUiBcblxuIFlPVVIgS0VZIDogXDAzM1swOzkybSVzJXMiJShyYixiYXNlc3BsaXQpKQ0KCQlwcmludCgiXDAzM1swOzkzbSAgICBUT09MIFBSSUNFIDogJXNSczE1MCIlKEgpKQ0KCQlwcmludCgiXDAzM1swOzkzbSAgICBWQUxJRElUWSA6ICVzNCBXZWVrcyIlKEgpKQ0KCQlzdWJwcm9jZXNzLmNoZWNrX291dHB1dChbImFtIiwgInN0YXJ0IiwgImh0dHBzOi8vd2EubWUvKzkyMzEzMDk5NzM3OCJdKQ0KCQlleGl0KCkNCg0KZGVmIGtleWNoZWNrKCk6DQogICAgdHJ5Og0KICAgICAgICBrID0gb3BlbigiL2RhdGEvZGF0YS9jb20udGVybXV4L2ZpbGVzL3Vzci9iaW4vLmxsdm0tY292IiwiciIpLnJlYWQoKQ0KICAgICAgICBpZiBrK2Jhc2VzcGxpdCBpbiBycToNCiAgICAgICAgICAgIG1lbnUoKQ0KICAgICAgICBlbHNlOmdlbmtleSgpDQogICAgZXhjZXB0KElPRXJyb3IpOg0KICAgICAgICBnZW5rZXkoKQ0KICAgCQ0KaWYgX19uYW1lX189PSdfX21haW5fXyc6DQoJb3Muc3lzdGVtKCdnaXQgcHVsbCcpDQoJZm9sZGVyKCkNCglrZXljaGVjaygpDQoNCg=="))
